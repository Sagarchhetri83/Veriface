(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[278],{273:function(t,e,n){"use strict";n.d(e,{aK:function(){return ev},Qr:function(){return eQ},bd:function(){return eq},ii:function(){return p},WI:function(){return eZ},JF:function(){return tb},qB:function(){return eB},_C:function(){return function t(e,n){var r=new w(n.width,n.height),o=r.width,i=r.height;if(o<=0||i<=0)throw Error("resizeResults - invalid dimensions: "+JSON.stringify({width:o,height:i}));if(Array.isArray(e))return e.map(function(e){return t(e,{width:o,height:i})});if(tY(e)){var a=e.detection.forSize(o,i),s=e.unshiftedLandmarks.forSize(a.box.width,a.box.height);return tX(G(e,a),s)}return X(e)?G(e,e.detection.forSize(o,i)):e instanceof N||e instanceof O?e.forSize(o,i):e}}});var r,o,i,a,s,c,u,f,h,p={};n.r(p),n.d(p,{AnchorPosition:function(){return u},DrawBox:function(){return ta},DrawBoxOptions:function(){return ti},DrawFaceLandmarks:function(){return tV},DrawFaceLandmarksOptions:function(){return tG},DrawTextField:function(){return to},DrawTextFieldOptions:function(){return tr},drawContour:function(){return d},drawDetections:function(){return ts},drawFaceExpressions:function(){return tW},drawFaceLandmarks:function(){return t$}});var l=n(4277);function d(t,e,n){if(void 0===n&&(n=!1),t.beginPath(),e.slice(1).forEach(function(n,r){var o=n.x,i=n.y,a=e[r];t.moveTo(a.x,a.y),t.lineTo(o,i)}),n){var r=e[e.length-1],o=e[0];if(!r||!o)return;t.moveTo(r.x,r.y),t.lineTo(o.x,o.y)}t.stroke()}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var v=function(t,e){return(v=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function m(t,e){function n(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var g=function(){return(g=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function b(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})}function y(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function _(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),o=0,e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var w=function(){function t(t,e){if(!T(t)||!T(e))throw Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}();function x(t,e){return t instanceof l.esB&&t.shape.length===e}function P(t){return x(t,4)}function E(t,e){void 0===e&&(e=2);var n=Math.pow(10,e);return Math.floor(t*n)/n}function M(t){return t&&t.width&&t.height}function F(t){return t.reduce(function(t,e){return t.add(e)},new B(0,0)).div(new B(t.length,t.length))}function I(t,e,n){return Array(t).fill(0).map(function(t,r){return e+r*n})}function T(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||0===t}function S(t){return T(t)&&0<=t&&t<=1}var B=function(){function t(t,e){this._x=t,this._y=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}(),C=function(){function t(e,n){void 0===n&&(n=!0);var r=e||{},o=[r.left,r.top,r.right,r.bottom].every(T),i=[r.x,r.y,r.width,r.height].every(T);if(!i&&!o)throw Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],c=a[1],u=a[2],f=a[3];t.assertIsValidBox({x:s,y:c,width:u,height:f},"Box.constructor",n),this._x=s,this._y=c,this._width=u,this._height=f}return t.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(T)},t.assertIsValidBox=function(e,n,r){if(void 0===r&&(r=!1),!t.isRect(e))throw Error(n+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw Error(n+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new B(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new B(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new B(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new B(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map(function(t){return Math.round(t)});return new t({x:e[0],y:e[1],width:e[2],height:e[3]})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map(function(t){return Math.floor(t)});return new t({x:e[0],y:e[1],width:e[2],height:e[3]})},t.prototype.toSquare=function(){var e=this.x,n=this.y,r=this.width,o=this.height,i=Math.abs(r-o);return r<o&&(e-=i/2,r+=i),o<r&&(n-=i/2,o+=i),new t({x:e,y:n,width:r,height:o})},t.prototype.rescale=function(e){var n=M(e)?e.width:e,r=M(e)?e.height:e;return new t({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},t.prototype.pad=function(e,n){var r=[this.x-e/2,this.y-n/2,this.width+e,this.height+n];return new t({x:r[0],y:r[1],width:r[2],height:r[3]})},t.prototype.clipAtImageBorders=function(e,n){var r=this.x,o=this.y,i=this.right,a=this.bottom,s=Math.max(r,0),c=Math.max(o,0);return new t({x:s,y:c,width:Math.min(i-s,e-s),height:Math.min(a-c,n-c)}).floor()},t.prototype.shift=function(e,n){var r=this.width,o=this.height;return new t({x:this.x+e,y:this.y+n,width:r,height:o})},t.prototype.padAtBorders=function(t,e){var n=this.width+1,r=this.height+1,o=n,i=r,a=this.left,s=this.top,c=this.right,u=this.bottom;return c>e&&(o=-c+e+n,c=e),u>t&&(i=-u+t+r,u=t),a<1&&(i=2-a,a=1),s<1&&(i=2-s,s=1),{dy:1,edy:i,dx:1,edx:o,y:s,ey:u,x:a,ex:c,w:n,h:r}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t}(),D=function(t){function e(e,n,r,o,i){return void 0===i&&(i=!1),t.call(this,{left:e,top:n,right:r,bottom:o},i)||this}return m(e,t),e}(C),A=function(){function t(t,e,n,r,o){this._imageDims=new w(o.width,o.height),this._score=t,this._classScore=e,this._className=n,this._box=new C(r).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new C(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:n})},t}(),O=function(t){function e(e,n,r){return t.call(this,e,e,"",n,r)||this}return m(e,t),e.prototype.forSize=function(n,r){var o=t.prototype.forSize.call(this,n,r);return new e(o.score,o.relativeBox,o.imageDims)},e}(A);function L(t,e,n,r){void 0===r&&(r=!0);for(var o=e.map(function(t,e){return{score:t,boxIndex:e}}).sort(function(t,e){return t.score-e.score}).map(function(t){return t.boxIndex}),i=[];o.length>0;)!function(){var e=o.pop();i.push(e);for(var a=o,s=[],c=0;c<a.length;c++){var u=a[c],f=t[e],h=t[u];s.push(function(t,e,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top));return n?r/(t.area+e.area-r):r/Math.min(t.area,e.area)}(f,h,r))}o=o.filter(function(t,e){return s[e]<=n})}();return i}function k(t,e){return l.lub(function(){var n=e[0],r=e[1],o=e[2],i=l.hlL(_(t.shape.slice(0,3),[1]),n),a=l.hlL(_(t.shape.slice(0,3),[1]),r),s=l.hlL(_(t.shape.slice(0,3),[1]),o),c=l.zoF([i,a,s],3);return l.luU(t,c)})}function R(t){return 1/(1+Math.exp(-t))}var j=function(t){function e(e,n,r,o,i){return void 0===i&&(i=!1),t.call(this,{x:e,y:n,width:r,height:o},i)||this}return m(e,t),e}(C),N=function(){function t(t,e,n){void 0===n&&(n=new B(0,0));var r=e.width,o=e.height;this._imgDims=new w(r,o),this._shift=n,this._positions=t.map(function(t){return t.mul(new B(r,o)).add(n)})}return Object.defineProperty(t.prototype,"shift",{get:function(){return new B(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(e){return e.sub(t._shift).div(new B(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),t.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},t.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new B(t,e))},t.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},t.prototype.align=function(t,e){if(void 0===e&&(e={}),t){var n=t instanceof O?t.box.floor():new C(t);return this.shiftBy(n.x,n.y).align(null,e)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),o=r.useDlibAlignment,i=r.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(i)},t.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],n=t[1],r=t[2],o=function(t){return r.sub(t).magnitude()},i=Math.floor((o(e)+o(n))/2/.45),a=F(t),s=Math.floor(Math.max(0,a.x-.5*i)),c=Math.floor(Math.max(0,a.y-.43*i));return new j(s,c,Math.min(i,this.imageWidth+s),Math.min(i,this.imageHeight+c))},t.prototype.alignMinBbox=function(t){var e,n,r,o=(n=(e=this.positions).map(function(t){return t.x}),r=e.map(function(t){return t.y}),new D(n.reduce(function(t,e){return e<t?e:t},1/0),r.reduce(function(t,e){return e<t?e:t},1/0),n.reduce(function(t,e){return t<e?e:t},0),r.reduce(function(t,e){return t<e?e:t},0)));return o.pad(o.width*t,o.height*t)},t.prototype.getRefPointsForAlignment=function(){throw Error("getRefPointsForAlignment not implemented by base class")},t}(),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],F([t[3],t[4]])]},e}(N),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(F)},e}(N),z=function(){function t(t,e){this._label=t,this._distance=e}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){return void 0===t&&(t=!0),""+this.label+(t?" ("+E(this.distance)+")":"")},t}(),W=function(t){function e(e,n){var r=t.call(this,e)||this;return r._label=n,r}return m(e,t),e.assertIsValidLabeledBox=function(t,e){if(C.assertIsValidBox(t,e),!T(t.label))throw Error(e+" - expected property label ("+t.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e}(C),Y=function(){function t(t,e){if("string"!=typeof t)throw Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(t){return!(t instanceof Float32Array)}))throw Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},t.fromJSON=function(e){var n=e.descriptors.map(function(t){return new Float32Array(t)});return new t(e.label,n)},t}();function X(t){return t.detection instanceof O}function G(t,e){return Object.assign({},t,{detection:e})}function V(){var t=window.fetch||function(){throw Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:function(){throw Error("readFile - filesystem not available for browser environment")}}}function $(t){var e="";if(!t)try{t=n(8730)}catch(t){e=t.toString()}return{readFile:t?function(e){return new Promise(function(n,r){t.readFile(e,function(t,e){return t?r(t):n(e)})})}:function(){throw Error("readFile - failed to require fs in nodejs environment with error: "+e)}}}function J(){var t=n.g.Canvas||n.g.HTMLCanvasElement,e=n.g.Image||n.g.HTMLImageElement,r=n.g.fetch||function(){throw Error("fetch - missing fetch implementation for nodejs environment")},o=$();return g({Canvas:t||function(){},CanvasRenderingContext2D:n.g.CanvasRenderingContext2D||function(){},Image:e||function(){},ImageData:n.g.ImageData||function(){},Video:n.g.HTMLVideoElement||function(){},createCanvasElement:function(){if(t)return new t;throw Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(e)return new e;throw Error("createImageElement - missing Image implementation for nodejs environment")},fetch:r},o)}function K(){return"object"==typeof window&&"undefined"!=typeof document&&"undefined"!=typeof HTMLImageElement&&"undefined"!=typeof HTMLCanvasElement&&"undefined"!=typeof HTMLVideoElement&&"undefined"!=typeof ImageData&&"undefined"!=typeof CanvasRenderingContext2D}!function(t){function e(e,n,r,o){var i=t.call(this,e,n)||this;return i._score=r,i._classScore=o,i}m(e,t),e.assertIsValidPredictedBox=function(t,e){if(W.assertIsValidLabeledBox(t,e),!S(t.score)||!S(t.classScore))throw Error(e+" - expected properties score ("+t.score+") and ("+t.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})}(W);var q=n(2601);function Q(){return"object"==typeof n.g&&void 0!==q&&!!q.version}function Z(){K()&&(c=V()),Q()&&(c=J())}var tt={getEnv:function(){if(!c)throw Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return c},setEnv:function(t){c=t},initialize:Z,createBrowserEnv:V,createFileSystem:$,createNodejsEnv:J,monkeyPatch:function(t){if(c||Z(),!c)throw Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,n=void 0===e?c.Canvas:e,r=t.Image,o=void 0===r?c.Image:r;c.Canvas=n,c.Image=o,c.createCanvasElement=t.createCanvasElement||function(){return new n},c.createImageElement=t.createImageElement||function(){return new o},c.ImageData=t.ImageData||c.ImageData,c.Video=t.Video||c.Video,c.fetch=t.fetch||c.fetch,c.readFile=t.readFile||c.readFile},isBrowser:K,isNodejs:Q};function te(t){return tt.isNodejs()||"string"!=typeof t?t:document.getElementById(t)}function tn(t){var e=tt.getEnv(),n=e.Canvas;if(t instanceof e.CanvasRenderingContext2D)return t;var r=te(t);if(!(r instanceof n))throw Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=r.getContext("2d");if(!o)throw Error("resolveContext2d - canvas 2d context is null");return o}Z(),(r=u||(u={})).TOP_LEFT="TOP_LEFT",r.TOP_RIGHT="TOP_RIGHT",r.BOTTOM_LEFT="BOTTOM_LEFT",r.BOTTOM_RIGHT="BOTTOM_RIGHT";var tr=function(t){void 0===t&&(t={});var e=t.anchorPosition,n=t.backgroundColor,r=t.fontColor,o=t.fontSize,i=t.fontStyle,a=t.padding;this.anchorPosition=e||u.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=o||14,this.fontStyle=i||"Georgia",this.padding=a||4},to=function(){function t(e,n,r){void 0===r&&(r={}),this.text="string"==typeof e?[e]:e instanceof t?e.text:e,this.anchor=n,this.options=new tr(r)}return t.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map(function(e){return t.measureText(e).width}).reduce(function(t,e){return t<e?e:t},0)+2*e},t.prototype.measureHeight=function(){var t=this.options,e=t.fontSize,n=t.padding;return this.text.length*e+2*n},t.prototype.getUpperLeft=function(t,e){var n=this.options.anchorPosition,r=n===u.BOTTOM_RIGHT||n===u.TOP_RIGHT,o=n===u.BOTTOM_LEFT||n===u.BOTTOM_RIGHT,i=this.measureWidth(t),a=this.measureHeight(),s=r?this.anchor.x-i:this.anchor.x,c=o?this.anchor.y-a:this.anchor.y;return e?{x:Math.max(Math.min(s,e.width-i),0),y:Math.max(Math.min(c,e.height-a),0)}:{x:s,y:c}},t.prototype.draw=function(t){var e=te(t),n=tn(e),r=this.options,o=r.backgroundColor,i=r.fontColor,a=r.fontSize,s=r.fontStyle,c=r.padding;n.font=a+"px "+s;var u=this.measureWidth(n),f=this.measureHeight();n.fillStyle=o;var h=this.getUpperLeft(n,e);n.fillRect(h.x,h.y,u,f),n.fillStyle=i,this.text.forEach(function(t,e){var r=c+h.x,o=c+h.y+(e+1)*a;n.fillText(t,r,o)})},t}(),ti=function(t){void 0===t&&(t={});var e=t.boxColor,n=t.lineWidth,r=t.label,o=t.drawLabelOptions;this.boxColor=e||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;var i={anchorPosition:u.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new tr(Object.assign({},i,o))},ta=function(){function t(t,e){void 0===e&&(e={}),this.box=new C(t),this.options=new ti(e)}return t.prototype.draw=function(t){var e=tn(t),n=this.options,r=n.boxColor,o=n.lineWidth,i=this.box,a=i.x,s=i.y,c=i.width,u=i.height;e.strokeStyle=r,e.lineWidth=o,e.strokeRect(a,s,c,u);var f=this.options.label;f&&new to([f],{x:a-o/2,y:s},this.options.drawLabelOptions).draw(t)},t}();function ts(t,e){(Array.isArray(e)?e:[e]).forEach(function(e){var n=e instanceof O?e.score:X(e)?e.detection.score:void 0;new ta(e instanceof O?e.box:X(e)?e.detection.box:new C(e),{label:n?""+E(n):void 0}).draw(t)})}function tc(t){var e=tt.getEnv(),n=e.Image,r=e.Video;return t instanceof n&&t.complete||t instanceof r&&t.readyState>=3}function tu(t){var e=tt.getEnv(),n=e.Image,r=e.Video;return t instanceof n?new w(t.naturalWidth,t.naturalHeight):t instanceof r?new w(t.videoWidth,t.videoHeight):new w(t.width,t.height)}function tf(t){var e=t.width,n=t.height,r=(0,tt.getEnv().createCanvasElement)();return r.width=e,r.height=n,r}function th(t,e){var n=tt.getEnv().ImageData;if(!(t instanceof n)&&!tc(t))throw Error("createCanvasFromMedia - media has not finished loading yet");var r=e||tu(t),o=r.width,i=r.height,a=tf({width:o,height:i});return t instanceof n?tn(a).putImageData(t,0,0):tn(a).drawImage(t,0,0,o,i),a}function tp(t){var e=tt.getEnv(),n=e.Image,r=e.Canvas,o=e.Video;return t instanceof n||t instanceof r||t instanceof o}var tl=function(){function t(t,e){var n=this;if(void 0===e&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach(function(t,e){if(x(t,3)){n._imageTensors[e]=t,n._inputDimensions[e]=t.shape;return}if(P(t)){var r=t.shape[0];if(1!==r)throw Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");n._imageTensors[e]=t,n._inputDimensions[e]=t.shape.slice(1);return}var o=t instanceof tt.getEnv().Canvas?t:th(t);n._canvases[e]=o,n._inputDimensions[e]=[o.height,o.width,3]})}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var t=this;return I(this.batchSize,0,1).map(function(e,n){return t.getReshapedInputDimensions(n)})},enumerable:!0,configurable:!0}),t.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},t.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},t.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},t.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},t.prototype.getReshapedInputDimensions=function(t){var e,n,r,o,i;if("number"!=typeof this.inputSize)throw Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return e={width:this.getInputWidth(t),height:this.getInputHeight(t)},n=this.inputSize,r=e.width,i=n/Math.max(o=e.height,r),new w(Math.round(r*i),Math.round(o*i))},t.prototype.toBatchTensor=function(t,e){var n=this;return void 0===e&&(e=!0),this._inputSize=t,l.lub(function(){var r=I(n.batchSize,0,1).map(function(r){var o=n.getInput(r);if(o instanceof l.esB){var i,a,s=P(o)?o:o.expandDims();return i=s,void 0===(a=e)&&(a=!1),((s=l.lub(function(){var t=i.shape.slice(1),e=t[0],n=t[1];if(e===n)return i;var r=Math.abs(e-n),o=e>n?2:1,s=function(t){var e=i.shape.slice();return e[o]=t,l.hlL(e,0)},c=s(Math.round(r*(a?.5:1))),u=r-c.shape[o],f=[a&&u?s(u):null,i,c].filter(function(t){return!!t}).map(function(t){return t.toFloat()});return l.zoF(f,o)})).shape[1]!==t||s.shape[2]!==t)&&(s=l.BHj.resizeBilinear(s,[t,t])),s.as3D(t,t,3)}if(o instanceof tt.getEnv().Canvas)return l.Xhn.fromPixels(function(t,e,n){void 0===n&&(n=!1);var r=tt.getEnv(),o=r.Image,i=r.Canvas;if(!(t instanceof o||t instanceof i))throw Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=tu(t),s=e/Math.max(a.height,a.width),c=s*a.width,u=s*a.height,f=tf({width:e,height:e}),h=t instanceof i?t:th(t),p=Math.abs(c-u)/2,l=n&&c<u?p:0,d=n&&u<c?p:0;return tn(f).drawImage(h,l,d,c,u),f}(o,t,e));throw Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+o)});return l.knu(r.map(function(t){return t.toFloat()})).as4D(n.batchSize,t,t,3)})},t}();function td(t){return b(this,void 0,void 0,function(){var e,n,r;return y(this,function(o){switch(o.label){case 0:if(t instanceof tl)return[2,t];if(!(e=Array.isArray(t)?t:[t]).length)throw Error("toNetInput - empty array passed as input");return n=function(e){return Array.isArray(t)?" at input index "+e+":":""},(r=e.map(te)).forEach(function(t,r){if(!tp(t)&&!x(t,3)&&!P(t)){if("string"==typeof e[r])throw Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+e[r]);throw Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(P(t)){var o=t.shape[0];if(1!==o)throw Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+o+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(t){return tp(t)&&new Promise(function(e,n){if(t instanceof tt.getEnv().Canvas||tc(t))return e();function r(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",o),e(t))}function o(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",o),n(t))}t.addEventListener("load",r),t.addEventListener("error",o)})}))];case 1:return o.sent(),[2,new tl(r,Array.isArray(t))]}})})}function tv(t,e){return b(this,void 0,void 0,function(){var n,r,o,i,a,s;return y(this,function(c){switch(c.label){case 0:if(n=tt.getEnv().Canvas,r=t,t instanceof n)return[3,5];return[4,td(t)];case 1:if((o=c.sent()).batchSize>1)throw Error("extractFaces - batchSize > 1 not supported");if(!((i=o.getInput(0))instanceof n))return[3,2];return a=i,[3,4];case 2:return[4,function(t,e){return b(this,void 0,void 0,function(){var e,n,r,o,i,a;return y(this,function(s){switch(s.label){case 0:return e=tt.getEnv().createCanvasElement(),r=(n=t.shape.slice(P(t)?1:0))[0],o=n[1],i=n[2],a=l.lub(function(){return t.as3D(r,o,i).toInt()}),[4,l.Xhn.toPixels(a,e)];case 1:return s.sent(),a.dispose(),[2,e]}})})}(i)];case 3:a=c.sent(),c.label=4;case 4:r=a,c.label=5;case 5:return s=tn(r),[2,e.map(function(t){return t instanceof O?t.forSize(r.width,r.height).box.floor():t}).map(function(t){return t.clipAtImageBorders(r.width,r.height)}).map(function(t){var e=t.x,n=t.y,r=t.width,o=t.height,i=tf({width:r,height:o});return tn(i).putImageData(s.getImageData(e,n,r,o),0,0),i})]}})})}function tm(t,e){return b(this,void 0,void 0,function(){return y(this,function(n){if(!x(t,3)&&!P(t))throw Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(P(t)&&t.shape[0]>1)throw Error("extractFaceTensors - batchSize > 1 not supported");return[2,l.lub(function(){var n=t.shape.slice(P(t)?1:0),r=n[0],o=n[1],i=n[2];return e.map(function(t){return t instanceof O?t.forSize(o,r).box:t}).map(function(t){return t.clipAtImageBorders(o,r)}).map(function(e){var n=e.x,a=e.y,s=e.width,c=e.height;return l.CnO(t.as3D(r,o,i),[a,n,0],[c,s,i])})})]})})}function tg(t,e){var n=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:n};if("/"===t)return{modelBaseUri:"/",manifestUri:"/"+n};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"",o=(t=t.replace(r,"")).split("/").filter(function(t){return t}),i=t.endsWith(".json")?o[o.length-1]:n,a=r+(t.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return{modelBaseUri:a=t.startsWith("/")?"/"+a:a,manifestUri:"/"===a?"/"+i:a+"/"+i}}function tb(t,e,n){void 0===n&&(n=!1);var r=n?tu(e):e,o=r.width,i=r.height;return t.width=o,t.height=i,{width:o,height:i}}var ty=function(){function t(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t);return e.obj[e.objProp]},t.prototype.reassignParamFromPath=function(t,e){var n=this.traversePropertyPath(t),r=n.obj,o=n.objProp;r[o].dispose(),r[o]=e},t.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(e){var n=e.paramPath;return{path:n,tensor:t.getParamFromPath(n)}})},t.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof l._wD})},t.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof l._wD)})},t.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(e){var n=e.path,r=e.tensor;t.reassignParamFromPath(n,r.variable())})},t.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(e){var n=e.path,r=e.tensor,o=l.XeE(r.dataSync());r.dispose(),t.reassignParamFromPath(n,o)})},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.getParamList().forEach(function(e){if(t&&e.tensor.isDisposed)throw Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){return Array.from(t.tensor.dataSync())}).reduce(function(t,e){return t.concat(e)}))},t.prototype.load=function(t){return b(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:if(t instanceof Float32Array)return this.extractWeights(t),[2];return[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}})})},t.prototype.loadFromUri=function(t){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:if(t&&"string"!=typeof t)throw Error(this._name+".loadFromUri - expected model uri");return[4,function(t,e){return b(this,void 0,void 0,function(){var n,r,o,i;return y(this,function(a){switch(a.label){case 0:return r=(n=tg(t,e)).manifestUri,o=n.modelBaseUri,[4,function(t){return b(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,function(t,e){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return[4,(0,tt.getEnv().fetch)(t,void 0)];case 1:if(!((e=n.sent()).status<400))throw Error("failed to fetch: ("+e.status+") "+e.statusText+", from url: "+e.url);return[2,e]}})})}(t)];case 1:return[2,e.sent().json()]}})})}(r)];case 1:return i=a.sent(),[2,l.io.loadWeights(i,o)]}})})}(t,this.getDefaultModelName())];case 1:return e=n.sent(),this.loadFromWeightMap(e),[2]}})})},t.prototype.loadFromDisk=function(t){return b(this,void 0,void 0,function(){var e,n,r,o,i,a,s,c,u,f;return y(this,function(h){switch(h.label){case 0:if(t&&"string"!=typeof t)throw Error(this._name+".loadFromDisk - expected model file path");return e=tt.getEnv().readFile,r=(n=tg(t,this.getDefaultModelName())).manifestUri,o=n.modelBaseUri,i=function(t){return Promise.all(t.map(function(t){return e(t).then(function(t){return t.buffer})}))},a=l.io.weightsLoaderFactory(i),u=(c=JSON).parse,[4,e(r)];case 1:return s=u.apply(c,[h.sent().toString()]),[4,a(s,o)];case 2:return f=h.sent(),this.loadFromWeightMap(f),[2]}})})},t.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),n=e.paramMappings,r=e.params;this._paramMappings=n,this._params=r},t.prototype.extractWeights=function(t){var e=this.extractParams(t),n=e.paramMappings,r=e.params;this._paramMappings=n,this._params=r},t.prototype.traversePropertyPath=function(t){if(!this.params)throw Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce(function(e,n){if(!e.nextObj.hasOwnProperty(n))throw Error("traversePropertyPath - object does not have property "+n+", for path "+t);return{obj:e.nextObj,objProp:n,nextObj:e.nextObj[n]}},{nextObj:this.params}),n=e.obj,r=e.objProp;if(!n||!r||!(n[r]instanceof l.esB))throw Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:r}},t}();function t_(t,e,n){return l.lub(function(){var r=l.U_I(t,e.depthwise_filter,e.pointwise_filter,n,"same");return l.IHx(r,e.bias)})}function tw(t,e,n){return void 0===n&&(n=!1),l.lub(function(){var r=l.UYe(n?l.IHx(l.Tek(t,e.conv0.filters,[2,2],"same"),e.conv0.bias):t_(t,e.conv0,[2,2])),o=t_(r,e.conv1,[1,1]),i=t_(l.UYe(l.IHx(r,o)),e.conv2,[1,1]);return l.UYe(l.IHx(r,l.IHx(o,i)))})}function tx(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),l.lub(function(){var o=l.UYe(n?l.IHx(l.Tek(t,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):t_(t,e.conv0,r?[2,2]:[1,1])),i=t_(o,e.conv1,[1,1]),a=t_(l.UYe(l.IHx(o,i)),e.conv2,[1,1]),s=t_(l.UYe(l.IHx(o,l.IHx(i,a))),e.conv3,[1,1]);return l.UYe(l.IHx(o,l.IHx(i,l.IHx(a,s))))})}function tP(t,e,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),l.lub(function(){var o=l.IHx(l.Tek(t,e.filters,[1,1],n),e.bias);return r?l.UYe(o):o})}function tE(t,e){Object.keys(t).forEach(function(n){e.some(function(t){return t.originalPath===n})||t[n].dispose()})}function tM(t,e){return function(n,r,o,i){var a=l.yXz(t(n*r*o*o),[o,o,n,r]),s=l.RRF(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function tF(t,e){return function(n,r,o){var i=l.odF(t(n*r),[n,r]),a=l.RRF(t(r));return e.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var tI=function(t,e,n){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=n};function tT(t,e){return function(n,r,o){var i=l.yXz(t(9*n),[3,3,n,1]),a=l.yXz(t(n*r),[1,1,n,r]),s=l.RRF(t(r));return e.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new tI(i,a,s)}}function tS(t){return function(e){return new tI(t(e+"/depthwise_filter",4),t(e+"/pointwise_filter",4),t(e+"/bias",1))}}function tB(t,e){return function(n,r,o){var i=t[n];if(!x(i,r))throw Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return e.push({originalPath:n,paramPath:o||n}),i}}function tC(t){var e=t;return{extractWeights:function(t){var n=e.slice(0,t);return e=e.slice(t),n},getRemainingWeights:function(){return e}}}function tD(t,e){var n=tM(t,e),r=tT(t,e);function o(t,e,o,i){return void 0===i&&(i=!1),{conv0:i?n(t,e,3,o+"/conv0"):r(t,e,o+"/conv0"),conv1:r(e,e,o+"/conv1"),conv2:r(e,e,o+"/conv2")}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:function(t,e,n,i){void 0===i&&(i=!1);var a=o(t,e,n,i);return{conv0:a.conv0,conv1:a.conv1,conv2:a.conv2,conv3:r(e,e,n+"/conv3")}}}}function tA(t){return function(e){return{filters:t(e+"/filters",4),bias:t(e+"/bias",1)}}}function tO(t,e){var n=tB(t,e),r=tA(n),o=tS(n);return{extractDenseBlock3Params:function(t,e){return void 0===e&&(e=!1),{conv0:e?r(t+"/conv0"):o(t+"/conv0"),conv1:o(t+"/conv1"),conv2:o(t+"/conv2")}},extractDenseBlock4Params:function(t,e){return void 0===e&&(e=!1),{conv0:e?r(t+"/conv0"):o(t+"/conv0"),conv1:o(t+"/conv1"),conv2:o(t+"/conv2"),conv3:o(t+"/conv3")}}}}var tL=function(t){function e(){return t.call(this,"FaceFeatureExtractor")||this}return m(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw Error("FaceFeatureExtractor - load model before inference");return l.lub(function(){var n=tx(k(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(l.iD$(255)),e.dense0,!0);return n=tx(n,e.dense1),n=tx(n,e.dense2),n=tx(n,e.dense3),n=l.wS1(n,[7,7],[2,2],"valid")})},e.prototype.forward=function(t){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,td(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(t){var e,n,r;return r={dense0:(n=tO(t,e=[]).extractDenseBlock4Params)("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")},tE(t,e),{params:r,paramMappings:e}},e.prototype.extractParams=function(t){return function(t){var e=[],n=tC(t),r=n.extractWeights,o=n.getRemainingWeights,i=tD(r,e).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),c=i(64,128,"dense2"),u=i(128,256,"dense3");if(0!==o().length)throw Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:c,dense3:u}}}(t)},e}(ty);function tk(t,e){return l.lub(function(){return l.IHx(l.OI3(t,e.weights),e.bias)})}function tR(t){var e={},n={};return Object.keys(t).forEach(function(r){(r.startsWith("fc")?n:e)[r]=t[r]}),{featureExtractorMap:e,classifierMap:n}}var tj=function(t){function e(e,n){var r=t.call(this,e)||this;return r._faceFeatureExtractor=n,r}return m(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw Error(this._name+" - load model before inference");return l.lub(function(){var r=t instanceof tl?e.faceFeatureExtractor.forwardInput(t):t;return tk(r.as2D(r.shape[0],-1),n.fc)})},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.params,r=e.paramMappings;this._params=n,this._paramMappings=r},e.prototype.extractClassifierParams=function(t){return function(t,e,n){var r=[],o=tC(t),i=o.extractWeights,a=o.getRemainingWeights,s=tF(i,r)(e,n,"fc");if(0!==a().length)throw Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:s}}}(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(t){var e,n,r,o=tR(t),i=o.featureExtractorMap,a=o.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(i),r={fc:{weights:(n=tB(a,e=[]))("fc/weights",2),bias:n("fc/bias",1)}},tE(a,e),{params:r,paramMappings:e}},e.prototype.extractParams=function(t){var e=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*e+n,o=t.slice(0,t.length-r),i=t.slice(t.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},e}(ty),tN=["neutral","happy","sad","angry","fearful","disgusted","surprised"],tH=function(){function t(t){var e=this;if(7!==t.length)throw Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);tN.forEach(function(n,r){e[n]=t[r]})}return t.prototype.asSortedArray=function(){var t=this;return tN.map(function(e){return{expression:e,probability:t[e]}}).sort(function(t,e){return e.probability-t.probability})},t}(),tU=function(t){function e(e){return void 0===e&&(e=new tL),t.call(this,"FaceExpressionNet",e)||this}return m(e,t),e.prototype.forwardInput=function(t){var e=this;return l.lub(function(){return l.XAC(e.runNet(t))})},e.prototype.forward=function(t){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,td(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.predictExpressions=function(t){return b(this,void 0,void 0,function(){var e,n,r,o,i=this;return y(this,function(a){switch(a.label){case 0:return[4,td(t)];case 1:return e=a.sent(),[4,this.forwardInput(e)];case 2:return n=a.sent(),[4,Promise.all(l.HHK(n).map(function(t){return b(i,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return[4,t.data()];case 1:return e=n.sent(),t.dispose(),[2,e]}})})}))];case 3:return r=a.sent(),n.dispose(),o=r.map(function(t){return new tH(t)}),[2,e.isBatchInput?o:o[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(tj);function tz(t,e){return Object.assign({},t,{expressions:e})}function tW(t,e,n,r){void 0===n&&(n=.1),(Array.isArray(e)?e:[e]).forEach(function(e){var o=e instanceof tH?e:e.expressions instanceof tH?e.expressions:void 0;if(!o)throw Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var i=o.asSortedArray().filter(function(t){return t.probability>n}),a=X(e)?e.detection.box.bottomLeft:r||new B(0,0);new to(i.map(function(t){return t.expression+" ("+E(t.probability)+")"}),a).draw(t)})}function tY(t){return X(t)&&t.landmarks instanceof N&&t.unshiftedLandmarks instanceof N&&t.alignedRect instanceof O}function tX(t,e){var n=t.detection.box,r=e.shiftBy(n.x,n.y),o=r.align(),i=t.detection.imageDims,a=new O(t.detection.score,o.rescale(i.reverse()),i);return Object.assign({},t,{landmarks:r,unshiftedLandmarks:e,alignedRect:a})}var tG=function(t){void 0===t&&(t={});var e=t.drawLines,n=t.drawPoints,r=t.lineWidth,o=t.lineColor,i=t.pointSize,a=t.pointColor;this.drawLines=void 0===e||e,this.drawPoints=void 0===n||n,this.lineWidth=r||1,this.pointSize=i||2,this.lineColor=o||"rgba(0, 255, 255, 1)",this.pointColor=a||"rgba(255, 0, 255, 1)"},tV=function(){function t(t,e){void 0===e&&(e={}),this.faceLandmarks=t,this.options=new tG(e)}return t.prototype.draw=function(t){var e=tn(t),n=this.options,r=n.drawLines,o=n.drawPoints,i=n.lineWidth,a=n.lineColor,s=n.pointSize,c=n.pointColor;r&&this.faceLandmarks instanceof U&&(e.strokeStyle=a,e.lineWidth=i,d(e,this.faceLandmarks.getJawOutline()),d(e,this.faceLandmarks.getLeftEyeBrow()),d(e,this.faceLandmarks.getRightEyeBrow()),d(e,this.faceLandmarks.getNose()),d(e,this.faceLandmarks.getLeftEye(),!0),d(e,this.faceLandmarks.getRightEye(),!0),d(e,this.faceLandmarks.getMouth(),!0)),o&&(e.strokeStyle=c,e.fillStyle=c,this.faceLandmarks.positions.forEach(function(t){e.beginPath(),e.arc(t.x,t.y,s,0,2*Math.PI),e.fill()}))},t}();function t$(t,e){(Array.isArray(e)?e:[e]).forEach(function(e){var n=e instanceof N?e:tY(e)?e.landmarks:void 0;if(!n)throw Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new tV(n).draw(t)})}function tJ(t,e,n){return l.IHx(l.Tek(t,e.filters,n,"same"),e.bias)}function tK(t,e,n){void 0===n&&(n=!0);var r=n?l.UYe(t):t;return r=t_(r,e.separable_conv0,[1,1]),r=t_(l.UYe(r),e.separable_conv1,[1,1]),r=l._sB(r,[3,3],[2,2],"same"),r=l.IHx(r,tJ(t,e.expansion_conv,[2,2]))}var tq=function(t){function e(e){var n=t.call(this,"TinyXception")||this;return n._numMainBlocks=e,n}return m(e,t),e.prototype.forwardInput=function(t){var e=this,n=this.params;if(!n)throw Error("TinyXception - load model before inference");return l.lub(function(){var r=k(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(l.iD$(256)),o=l.UYe(tJ(r,n.entry_flow.conv_in,[2,2]));return o=tK(o,n.entry_flow.reduction_block_0,!1),o=tK(o,n.entry_flow.reduction_block_1),I(e._numMainBlocks,0,1).forEach(function(t){var e,r,i;e=o,r=n.middle_flow["main_block_"+t],i=t_(l.UYe(e),r.separable_conv0,[1,1]),i=t_(l.UYe(i),r.separable_conv1,[1,1]),i=t_(l.UYe(i),r.separable_conv2,[1,1]),o=i=l.IHx(i,e)}),o=tK(o,n.exit_flow.reduction_block),o=l.UYe(t_(o,n.exit_flow.separable_conv,[1,1]))})},e.prototype.forward=function(t){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,td(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t,e){var n,r,o,i=[],a={extractConvParams:r=tA(n=tB(t,i)),extractSeparableConvParams:o=tS(n),extractReductionBlockParams:function(t){return{separable_conv0:o(t+"/separable_conv0"),separable_conv1:o(t+"/separable_conv1"),expansion_conv:r(t+"/expansion_conv")}},extractMainBlockParams:function(t){return{separable_conv0:o(t+"/separable_conv0"),separable_conv1:o(t+"/separable_conv1"),separable_conv2:o(t+"/separable_conv2")}}},s=a.extractConvParams,c=a.extractSeparableConvParams,u=a.extractReductionBlockParams,f=a.extractMainBlockParams,h=s("entry_flow/conv_in"),p=u("entry_flow/reduction_block_0"),l=u("entry_flow/reduction_block_1"),d={};I(e,0,1).forEach(function(t){d["main_block_"+t]=f("middle_flow/main_block_"+t)});var v=u("exit_flow/reduction_block"),m=c("exit_flow/separable_conv");return tE(t,i),{params:{entry_flow:{conv_in:h,reduction_block_0:p,reduction_block_1:l},middle_flow:d,exit_flow:{reduction_block:v,separable_conv:m}},paramMappings:i}}(t,this._numMainBlocks)},e.prototype.extractParams=function(t){return function(t,e){var n,r,o=[],i=tC(t),a=i.extractWeights,s=i.getRemainingWeights,c={extractConvParams:n=tM(a,o),extractSeparableConvParams:r=tT(a,o),extractReductionBlockParams:function(t,e,o){return{separable_conv0:r(t,e,o+"/separable_conv0"),separable_conv1:r(e,e,o+"/separable_conv1"),expansion_conv:n(t,e,1,o+"/expansion_conv")}},extractMainBlockParams:function(t,e){return{separable_conv0:r(t,t,e+"/separable_conv0"),separable_conv1:r(t,t,e+"/separable_conv1"),separable_conv2:r(t,t,e+"/separable_conv2")}}},u=c.extractConvParams,f=c.extractSeparableConvParams,h=c.extractReductionBlockParams,p=c.extractMainBlockParams,l=u(3,32,3,"entry_flow/conv_in"),d=h(32,64,"entry_flow/reduction_block_0"),v=h(64,128,"entry_flow/reduction_block_1"),m={};I(e,0,1).forEach(function(t){m["main_block_"+t]=p(128,"middle_flow/main_block_"+t)});var g=h(128,256,"exit_flow/reduction_block"),b=f(256,512,"exit_flow/separable_conv");if(0!==s().length)throw Error("weights remaing after extract: "+s().length);return{paramMappings:o,params:{entry_flow:{conv_in:l,reduction_block_0:d,reduction_block_1:v},middle_flow:m,exit_flow:{reduction_block:g,separable_conv:b}}}}(t,this._numMainBlocks)},e}(ty);(o=f||(f={})).FEMALE="female",o.MALE="male";var tQ=function(t){function e(e){void 0===e&&(e=new tq(2));var n=t.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=e,n}return m(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw Error(this._name+" - load model before inference");return l.lub(function(){var r=t instanceof tl?e.faceFeatureExtractor.forwardInput(t):t,o=l.wS1(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1);return{age:tk(o,n.fc.age).as1D(),gender:tk(o,n.fc.gender)}})},e.prototype.forwardInput=function(t){var e=this;return l.lub(function(){var n=e.runNet(t),r=n.age,o=n.gender;return{age:r,gender:l.XAC(o)}})},e.prototype.forward=function(t){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,td(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.predictAgeAndGender=function(t){return b(this,void 0,void 0,function(){var e,n,r,o,i,a=this;return y(this,function(s){switch(s.label){case 0:return[4,td(t)];case 1:return e=s.sent(),[4,this.forwardInput(e)];case 2:return n=s.sent(),r=l.HHK(n.age),o=l.HHK(n.gender),[4,Promise.all(r.map(function(t,e){return{ageTensor:t,genderTensor:o[e]}}).map(function(t){var e=t.ageTensor,n=t.genderTensor;return b(a,void 0,void 0,function(){var t,r,o,i,a;return y(this,function(s){switch(s.label){case 0:return[4,e.data()];case 1:return t=s.sent()[0],[4,n.data()];case 2:return i=(o=(r=s.sent()[0])>.5)?f.MALE:f.FEMALE,a=o?r:1-r,e.dispose(),n.dispose(),[2,{age:t,gender:i,genderProbability:a}]}})})}))];case 3:return i=s.sent(),n.age.dispose(),n.gender.dispose(),[2,e.isBatchInput?i:i[0]]}})})},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.params,r=e.paramMappings;this._params=n,this._paramMappings=r},e.prototype.extractClassifierParams=function(t){return function(t){var e=[],n=tC(t),r=n.extractWeights,o=n.getRemainingWeights,i=tF(r,e),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(0!==o().length)throw Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{fc:{age:a,gender:s}}}}(t)},e.prototype.extractParamsFromWeigthMap=function(t){var e=tR(t),n=e.featureExtractorMap,r=e.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(t){var e=[],n=tB(t,e);function r(t){return{weights:n(t+"/weights",2),bias:n(t+"/bias",1)}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return tE(t,e),{params:o,paramMappings:e}}(r)},e.prototype.extractParams=function(t){var e=t.slice(0,t.length-1539),n=t.slice(t.length-1539);return this.faceFeatureExtractor.extractWeights(e),this.extractClassifierParams(n)},e}(ty),tZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.postProcess=function(t,e,n){var r=n.map(function(t){var n=t.width,r=t.height,o=e/Math.max(r,n);return{width:n*o,height:r*o}}),o=r.length;return l.lub(function(){var n=function(t,e){return l.knu([l.hlL([68],t),l.hlL([68],e)],1).as2D(1,136).as1D()},i=function(t,e){var n=r[t],o=n.width,i=n.height;return e(o,i)?Math.abs(o-i)/2:0};return t.mul(l.hlL([o,136],e)).sub(l.knu(Array.from(Array(o),function(t,e){return n(i(e,function(t,e){return t<e}),i(e,function(t,e){return e<t}))}))).div(l.knu(Array.from(Array(o),function(t,e){return n(r[e].width,r[e].height)})))})},e.prototype.forwardInput=function(t){var e=this;return l.lub(function(){var n=e.runNet(t);return e.postProcess(n,t.inputSize,t.inputDimensions.map(function(t){return{height:t[0],width:t[1]}}))})},e.prototype.forward=function(t){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,td(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.detectLandmarks=function(t){return b(this,void 0,void 0,function(){var e,n,r,o=this;return y(this,function(i){switch(i.label){case 0:return[4,td(t)];case 1:return e=i.sent(),[4,Promise.all((n=l.lub(function(){return l.HHK(o.forwardInput(e))})).map(function(t,n){return b(o,void 0,void 0,function(){var r,o,i,a,s;return y(this,function(c){switch(c.label){case 0:return i=(o=Array).from,[4,t.data()];case 1:return a=(r=i.apply(o,[c.sent()])).filter(function(t,e){return e%2==0}),s=r.filter(function(t,e){return e%2!=0}),[2,new U(Array(68).fill(0).map(function(t,e){return new B(a[e],s[e])}),{height:e.getInputHeight(n),width:e.getInputWidth(n)})]}})})}))];case 2:return r=i.sent(),n.forEach(function(t){return t.dispose()}),[2,e.isBatchInput?r:r[0]]}})})},e.prototype.getClassifierChannelsOut=function(){return 136},e}(tj),t0=function(t){function e(e){return void 0===e&&(e=new tL),t.call(this,"FaceLandmark68Net",e)||this}return m(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(tZ),t1=function(t){function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return m(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw Error("TinyFaceFeatureExtractor - load model before inference");return l.lub(function(){var n=tw(k(t.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(l.iD$(255)),e.dense0,!0);return n=tw(n,e.dense1),n=tw(n,e.dense2),n=l.wS1(n,[14,14],[2,2],"valid")})},e.prototype.forward=function(t){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,td(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(t){var e,n,r;return r={dense0:(n=tO(t,e=[]).extractDenseBlock3Params)("dense0",!0),dense1:n("dense1"),dense2:n("dense2")},tE(t,e),{params:r,paramMappings:e}},e.prototype.extractParams=function(t){return function(t){var e=[],n=tC(t),r=n.extractWeights,o=n.getRemainingWeights,i=tD(r,e).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),c=i(64,128,"dense2");if(0!==o().length)throw Error("weights remaing after extract: "+o().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:c}}}(t)},e}(ty),t2=function(t){function e(e){return void 0===e&&(e=new t1),t.call(this,"FaceLandmark68TinyNet",e)||this}return m(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(tZ);function t4(t,e,n,r,o){void 0===o&&(o="same");var i,a,s=e.conv,c=s.filters,u=s.bias,f=l.Tek(t,c,n,o);return i=f=l.IHx(f,u),a=e.scale,f=l.IHx(l.dC7(i,a.weights),a.biases),r?l.UYe(f):f}function t3(t,e){return t4(t,e,[1,1],!1)}function t6(t,e){return t4(t,e,[2,2],!0,"valid")}function t5(t,e){var n=t4(t,e.conv1,[1,1],!0);return n=t3(n,e.conv2),n=l.IHx(n,t),n=l.UYe(n)}function t8(t,e){var n=t6(t,e.conv1);n=t3(n,e.conv2);var r=l.wS1(t,2,2,"valid"),o=l.lls(r.shape),i=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){var a=_(n.shape);a[1]=1;var s=l.lls(a),c=_((n=l.zoF([n,s],1)).shape);c[2]=1;var u=l.lls(c);n=l.zoF([n,u],2)}return r=i?l.zoF([r,o],3):r,n=l.IHx(r,n),n=l.UYe(n)}m(function(){return null!==i&&i.apply(this,arguments)||this},i=t0);var t7=function(t){function e(){return t.call(this,"FaceRecognitionNet")||this}return m(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw Error("FaceRecognitionNet - load model before inference");return l.lub(function(){var n=t6(k(t.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(l.iD$(256)),e.conv32_down);n=t5(n=l._sB(n,3,2,"valid"),e.conv32_1),n=t5(n,e.conv32_2),n=t8(n=t5(n,e.conv32_3),e.conv64_down),n=t5(n,e.conv64_1),n=t5(n,e.conv64_2),n=t8(n=t5(n,e.conv64_3),e.conv128_down),n=t5(n,e.conv128_1),n=t8(n=t5(n,e.conv128_2),e.conv256_down),n=t5(n,e.conv256_1);var r=(n=t8(n=t5(n,e.conv256_2),e.conv256_down_out)).mean([1,2]);return l.OI3(r,e.fc)})},e.prototype.forward=function(t){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,td(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.computeFaceDescriptor=function(t){return b(this,void 0,void 0,function(){var e,n,r,o=this;return y(this,function(i){switch(i.label){case 0:return[4,td(t)];case 1:return e=i.sent(),[4,Promise.all((n=l.lub(function(){return l.HHK(o.forwardInput(e))})).map(function(t){return t.data()}))];case 2:return r=i.sent(),n.forEach(function(t){return t.dispose()}),[2,e.isBatchInput?r:r[0]]}})})},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=function(t,e){var n=tB(t,e);function r(t){return{conv:{filters:n(t+"/conv/filters",4),bias:n(t+"/conv/bias",1)},scale:{weights:n(t+"/scale/weights",1),biases:n(t+"/scale/biases",1)}}}return{extractConvLayerParams:r,extractResidualLayerParams:function(t){return{conv1:r(t+"/conv1"),conv2:r(t+"/conv2")}}}}(t,e),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),c=o("conv32_3"),u=o("conv64_down"),f=o("conv64_1"),h=o("conv64_2"),p=o("conv64_3"),l=o("conv128_down"),d=o("conv128_1"),v=o("conv128_2"),m=o("conv256_down"),g=o("conv256_1"),b=o("conv256_2"),y=o("conv256_down_out"),_=t.fc;if(e.push({originalPath:"fc",paramPath:"fc"}),!x(_,2))throw Error("expected weightMap[fc] to be a Tensor2D, instead have "+_);return tE(t,e),{params:{conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:c,conv64_down:u,conv64_1:f,conv64_2:h,conv64_3:p,conv128_down:l,conv128_1:d,conv128_2:v,conv256_down:m,conv256_1:g,conv256_2:b,conv256_down_out:y,fc:_},paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=tC(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=function(t,e){function n(n,r,o,i){var a,s,c,u,f,h;return{conv:(a=i+"/conv",s=function(e,n,r){var o=t(e),i=o.length/(n*r*r);if(i%1!=0)throw Error("depth has to be an integer: "+i+", weights.length: "+o.length+", numFilters: "+n+", filterSize: "+r);return l.lub(function(){return l.p4s(l.yXz(o,[n,i,r,r]),[2,3,1,0])})}(n,r,o),c=l.RRF(t(r)),e.push({paramPath:a+"/filters"},{paramPath:a+"/bias"}),{filters:s,bias:c}),scale:(u=i+"/scale",f=l.RRF(t(r)),h=l.RRF(t(r)),e.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:f,biases:h})}}return{extractConvLayerParams:n,extractResidualLayerParams:function(t,e,r,o,i){return void 0===i&&(i=!1),{conv1:n((i?.5:1)*t,e,r,o+"/conv1"),conv2:n(t,e,r,o+"/conv2")}}}}(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,c=a(4704,32,7,"conv32_down"),u=s(9216,32,3,"conv32_1"),f=s(9216,32,3,"conv32_2"),h=s(9216,32,3,"conv32_3"),p=s(36864,64,3,"conv64_down",!0),d=s(36864,64,3,"conv64_1"),v=s(36864,64,3,"conv64_2"),m=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),b=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),_=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),x=s(589824,256,3,"conv256_2"),P=s(589824,256,3,"conv256_down_out"),E=l.lub(function(){return l.p4s(l.odF(n(32768),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),0!==r().length)throw Error("weights remaing after extract: "+r().length);return{params:{conv32_down:c,conv32_1:u,conv32_2:f,conv32_3:h,conv64_down:p,conv64_1:d,conv64_2:v,conv64_3:m,conv128_down:g,conv128_1:b,conv128_2:y,conv256_down:_,conv256_1:w,conv256_2:x,conv256_down_out:P,fc:E},paramMappings:o}}(t)},e}(ty);function t9(t,e,n){return Object.assign({},t,{gender:e,genderProbability:n})}var et=function(){function t(t){var e=void 0===t?{}:t,n=e.minFaceSize,r=e.scaleFactor,o=e.maxNumScales,i=e.scoreThresholds,a=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=o||10,this._scoreThresholds=i||[.6,.7,.7],this._scaleSteps=a,"number"!=typeof this._minFaceSize||this._minFaceSize<0)throw Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!=typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!=typeof this._maxNumScales||this._maxNumScales<0)throw Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some(function(t){return"number"!=typeof t}))throw Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(t){return"number"!=typeof t})))throw Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function ee(t,e,n){return l.lub(function(){var r=l.Tek(t,e.filters,n,"same");return r=l.IHx(r,e.batch_norm_offset),l.iUl(r,0,6)})}function en(t,e){return l.lub(function(){var n=t.shape[0];return{boxPredictionEncoding:l.XLQ(tP(t,e.box_encoding_predictor),[n,-1,1,4]),classPrediction:l.XLQ(tP(t,e.class_predictor),[n,-1,3])}})}var er=function(){function t(t){var e=void 0===t?{}:t,n=e.minConfidence,r=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!=typeof this._maxResults)throw Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),eo=function(t){function e(){return t.call(this,"SsdMobilenetv1")||this}return m(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw Error("SsdMobilenetv1 - load model before inference");return l.lub(function(){var n,r,o,i,a,s,c=t.toBatchTensor(512,!1).toFloat(),u=(n=l.luU(l.dC7(c,l.iD$(.007843137718737125)),l.iD$(1)),r=e.mobilenetv1,l.lub(function(){var t=null,e=ee(n,r.conv_0,[2,2]);if([r.conv_1,r.conv_2,r.conv_3,r.conv_4,r.conv_5,r.conv_6,r.conv_7,r.conv_8,r.conv_9,r.conv_10,r.conv_11,r.conv_12,r.conv_13].forEach(function(n,r){var o,i,a=r+1,s=[2,4,6,12].some(function(t){return t===a})?[2,2]:[1,1];o=e,i=n.depthwise_conv,e=ee(e=l.lub(function(){var t=l.B10(o,i.filters,s,"same");return t=l.tgs(t,i.batch_norm_mean,i.batch_norm_variance,i.batch_norm_offset,i.batch_norm_scale,.0010000000474974513),l.iUl(t,0,6)}),n.pointwise_conv,[1,1]),11===a&&(t=e)}),null===t)throw Error("mobileNetV1 - output of conv layer 11 is null");return{out:e,conv11:t}})),f=(o=u.out,i=u.conv11,a=e.prediction_layer,l.lub(function(){var t=ee(o,a.conv_0,[1,1]),e=ee(t,a.conv_1,[2,2]),n=ee(e,a.conv_2,[1,1]),r=ee(n,a.conv_3,[2,2]),s=ee(r,a.conv_4,[1,1]),c=ee(s,a.conv_5,[2,2]),u=ee(c,a.conv_6,[1,1]),f=ee(u,a.conv_7,[2,2]),h=en(i,a.box_predictor_0),p=en(o,a.box_predictor_1),d=en(e,a.box_predictor_2),v=en(r,a.box_predictor_3),m=en(c,a.box_predictor_4),g=en(f,a.box_predictor_5);return{boxPredictions:l.zoF([h.boxPredictionEncoding,p.boxPredictionEncoding,d.boxPredictionEncoding,v.boxPredictionEncoding,m.boxPredictionEncoding,g.boxPredictionEncoding],1),classPredictions:l.zoF([h.classPrediction,p.classPrediction,d.classPrediction,v.classPrediction,m.classPrediction,g.classPrediction],1)}})),h=f.boxPredictions,p=f.classPredictions;return s=e.output_layer,l.lub(function(){var t,e,n,r,o,i,a,c,u,f,d,v,m,g=h.shape[0],b=(t=l.XLQ(l.Gg6(s.extra_dim,[g,1,1]),[-1,4]),e=l.XLQ(h,[-1,4]),a=(n=l.HHK(l.p4s(t,[1,0])),r=[l.luU(n[2],n[0]),l.luU(n[3],n[1])],o=[l.IHx(n[0],l.hiC(r[0],l.iD$(2))),l.IHx(n[1],l.hiC(r[1],l.iD$(2)))],i={sizes:r,centers:o}).sizes,c=i.centers,u=l.HHK(l.p4s(e,[1,0])),f=l.hiC(l.dC7(l.Qqt(l.hiC(u[2],l.iD$(5))),a[0]),l.iD$(2)),d=l.IHx(l.dC7(l.hiC(u[0],l.iD$(10)),a[0]),c[0]),v=l.hiC(l.dC7(l.Qqt(l.hiC(u[3],l.iD$(5))),a[1]),l.iD$(2)),m=l.IHx(l.dC7(l.hiC(u[1],l.iD$(10)),a[1]),c[1]),l.p4s(l.knu([l.luU(d,f),l.luU(m,v),l.IHx(d,f),l.IHx(m,v)]),[1,0]));b=l.XLQ(b,[g,b.shape[0]/g,4]);var y=l.XD2(l.tPi(p,[0,0,1],[-1,-1,-1])),_=l.tPi(y,[0,0,0],[-1,-1,1]);return _=l.XLQ(_,[g,_.shape[1]]),{boxes:l.HHK(b),scores:l.HHK(_)}})})},e.prototype.forward=function(t){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=this.forwardInput,[4,td(t)];case 1:return[2,e.apply(this,[n.sent()])]}})})},e.prototype.locateFaces=function(t,e){return void 0===e&&(e={}),b(this,void 0,void 0,function(){var n,r,o,i,a,s,c,u,f,h,p,l,d,v,m,g,b,_,w,x;return y(this,function(y){switch(y.label){case 0:return r=(n=new er(e)).maxResults,o=n.minConfidence,[4,td(t)];case 1:for(i=y.sent(),s=(a=this.forwardInput(i)).boxes,c=a.scores,u=s[0],f=c[0],h=1;h<s.length;h++)s[h].dispose(),c[h].dispose();return d=(l=Array).from,[4,f.data()];case 2:var P,E,M,F,I,T;return p=d.apply(l,[y.sent()]),P=u,E=r,M=o,F=Math.min(E,P.shape[0]),I=p.map(function(t,e){return{score:t,boxIndex:e}}).filter(function(t){return t.score>M}).sort(function(t,e){return e.score-t.score}),T=[],I.forEach(function(t){if(!(T.length>=F)){for(var e=t.score,n=T.length-1;n>=0;--n){var r=function(t,e,n){var r=t.arraySync(),o=Math.min(r[e][0],r[e][2]),i=Math.min(r[e][1],r[e][3]),a=Math.max(r[e][0],r[e][2]),s=Math.max(r[e][1],r[e][3]),c=Math.min(r[n][0],r[n][2]),u=Math.min(r[n][1],r[n][3]),f=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),p=(a-o)*(s-i),l=(f-c)*(h-u);if(p<=0||l<=0)return 0;var d=Math.max(Math.min(a,f)-Math.max(o,c),0)*Math.max(Math.min(s,h)-Math.max(i,u),0);return d/(p+l-d)}(P,t.boxIndex,T[n]);if(0!==r&&(t.score*=r<=.5?1:0,t.score<=M))break}e===t.score&&T.push(t.boxIndex)}}),v=T,m=i.getReshapedInputDimensions(0),b=(g=i.inputSize)/m.width,_=g/m.height,w=u.arraySync(),x=v.map(function(t){var e=[Math.max(0,w[t][0]),Math.min(1,w[t][2])].map(function(t){return t*_}),n=e[0],r=e[1],o=[Math.max(0,w[t][1]),Math.min(1,w[t][3])].map(function(t){return t*b}),a=o[0],s=o[1];return new O(p[t],new j(a,n,s-a,r-n),{height:i.getInputHeight(0),width:i.getInputWidth(0)})}),u.dispose(),f.dispose(),[2,x]}})})},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(t){return function(t){var e=[],n=function(t,e){var n=tB(t,e);function r(t,e,r){return{filters:n(t+"/Conv2d_"+e+"_pointwise/weights",4,r+"/filters"),batch_norm_offset:n(t+"/Conv2d_"+e+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset")}}function o(t){var e="mobilenetv1/conv_"+t,o="MobilenetV1/Conv2d_"+t+"_depthwise",i=e+"/depthwise_conv";return{depthwise_conv:{filters:n(o+"/depthwise_weights",4,i+"/filters"),batch_norm_scale:n(o+"/BatchNorm/gamma",1,i+"/batch_norm_scale"),batch_norm_offset:n(o+"/BatchNorm/beta",1,i+"/batch_norm_offset"),batch_norm_mean:n(o+"/BatchNorm/moving_mean",1,i+"/batch_norm_mean"),batch_norm_variance:n(o+"/BatchNorm/moving_variance",1,i+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",t,e+"/pointwise_conv")}}function i(t,e){return{filters:n(t+"/weights",4,e+"/filters"),bias:n(t+"/biases",1,e+"/bias")}}function a(t){return{box_encoding_predictor:i("Prediction/BoxPredictor_"+t+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+t+"/box_encoding_predictor"),class_predictor:i("Prediction/BoxPredictor_"+t+"/ClassPredictor","prediction_layer/box_predictor_"+t+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}}}(t,e),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!x(i,3))throw Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return tE(t,e),{params:a,paramMappings:e}}(t)},e.prototype.extractParams=function(t){return function(t){var e=[],n=tC(t),r=n.extractWeights,o=n.getRemainingWeights,i=function(t,e){function n(n,r,o,i,a){var s=l.yXz(t(n*r*o*o),[o,o,n,r]),c=l.RRF(t(r));return e.push({paramPath:i+"/filters"},{paramPath:i+"/"+(a?"batch_norm_offset":"bias")}),{filters:s,bias:c}}function r(t,e,r,o){var i=n(t,e,r,o,!0);return{filters:i.filters,batch_norm_offset:i.bias}}function o(n,o,i){var a,s,c,u,f,h;return{depthwise_conv:(a=i+"/depthwise_conv",s=l.yXz(t(9*n),[3,3,n,1]),c=l.RRF(t(n)),u=l.RRF(t(n)),f=l.RRF(t(n)),h=l.RRF(t(n)),e.push({paramPath:a+"/filters"},{paramPath:a+"/batch_norm_scale"},{paramPath:a+"/batch_norm_offset"},{paramPath:a+"/batch_norm_mean"},{paramPath:a+"/batch_norm_variance"}),{filters:s,batch_norm_scale:c,batch_norm_offset:u,batch_norm_mean:f,batch_norm_variance:h}),pointwise_conv:r(n,o,1,i+"/pointwise_conv")}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:o(32,64,"mobilenetv1/conv_1"),conv_2:o(64,128,"mobilenetv1/conv_2"),conv_3:o(128,128,"mobilenetv1/conv_3"),conv_4:o(128,256,"mobilenetv1/conv_4"),conv_5:o(256,256,"mobilenetv1/conv_5"),conv_6:o(256,512,"mobilenetv1/conv_6"),conv_7:o(512,512,"mobilenetv1/conv_7"),conv_8:o(512,512,"mobilenetv1/conv_8"),conv_9:o(512,512,"mobilenetv1/conv_9"),conv_10:o(512,512,"mobilenetv1/conv_10"),conv_11:o(512,512,"mobilenetv1/conv_11"),conv_12:o(512,1024,"mobilenetv1/conv_12"),conv_13:o(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}(r,e),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,c=a(),u=s(),f=l.wOQ(r(20472),[1,5118,4]);if(e.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:c,prediction_layer:u,output_layer:{extra_dim:f}},paramMappings:e}}(t)},e}(ty);m(function(){return null!==a&&a.apply(this,arguments)||this},a=eo);var ei=[new B(.738768,.874946),new B(2.42204,2.65704),new B(4.30971,7.04493),new B(10.246,4.59428),new B(12.6868,11.8741)],ea=[new B(1.603231,2.094468),new B(6.041143,7.080126),new B(2.882459,3.518061),new B(4.266906,5.178857),new B(9.041765,10.66308)],es=[117.001,114.697,97.404],ec=function(t){return"number"==typeof t};function eu(t){return l.lub(function(){var e=l.dC7(t,l.iD$(.10000000149011612));return l.IHx(l.UYe(l.luU(t,e)),e)})}function ef(t,e){return l.lub(function(){var n=l.vku(t,[[0,0],[1,1],[1,1],[0,0]]);return n=l.Tek(n,e.conv.filters,[1,1],"valid"),n=l.luU(n,e.bn.sub),n=l.dC7(n,e.bn.truediv),eu(n=l.IHx(n,e.conv.bias))})}function eh(t,e){return l.lub(function(){var n=l.vku(t,[[0,0],[1,1],[1,1],[0,0]]);return n=l.U_I(n,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),eu(n=l.IHx(n,e.bias))})}(s=h||(h={}))[s.XS=224]="XS",s[s.SM=320]="SM",s[s.MD=416]="MD",s[s.LG=608]="LG";var ep=function(){function t(t){var e=void 0===t?{}:t,n=e.inputSize,r=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!=typeof this._inputSize||this._inputSize%32!=0)throw Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),el=function(t){function e(e){var n=t.call(this,"TinyYolov2")||this;return!function(t){if(!t)throw Error("invalid config: "+t);if("boolean"!=typeof t.withSeparableConvs)throw Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!ec(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every(function(t){return"string"==typeof t}))throw Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map(function(t){return t||{}}).every(function(t){return ec(t.x)&&ec(t.y)}))throw Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||3!==t.meanRgb.length||!t.meanRgb.every(ec)))throw Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}(e),n._config=e,n}return m(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(t,e){var n=ef(t,e.conv0);return n=ef(n=l._sB(n,[2,2],[2,2],"same"),e.conv1),n=ef(n=l._sB(n,[2,2],[2,2],"same"),e.conv2),n=ef(n=l._sB(n,[2,2],[2,2],"same"),e.conv3),n=ef(n=l._sB(n,[2,2],[2,2],"same"),e.conv4),n=ef(n=l._sB(n,[2,2],[2,2],"same"),e.conv5),n=ef(n=l._sB(n,[2,2],[1,1],"same"),e.conv6),tP(n=ef(n,e.conv7),e.conv8,"valid",!1)},e.prototype.runMobilenet=function(t,e){var n=this.config.isFirstLayerConv2d?eu(tP(t,e.conv0,"valid",!1)):eh(t,e.conv0);return n=eh(n=l._sB(n,[2,2],[2,2],"same"),e.conv1),n=eh(n=l._sB(n,[2,2],[2,2],"same"),e.conv2),n=eh(n=l._sB(n,[2,2],[2,2],"same"),e.conv3),n=eh(n=l._sB(n,[2,2],[2,2],"same"),e.conv4),n=eh(n=l._sB(n,[2,2],[2,2],"same"),e.conv5),n=l._sB(n,[2,2],[1,1],"same"),n=e.conv6?eh(n,e.conv6):n,tP(n=e.conv7?eh(n,e.conv7):n,e.conv8,"valid",!1)},e.prototype.forwardInput=function(t,e){var n=this,r=this.params;if(!r)throw Error("TinyYolov2 - load model before inference");return l.lub(function(){var o=t.toBatchTensor(e,!1).toFloat();return o=(o=n.config.meanRgb?k(o,n.config.meanRgb):o).div(l.iD$(256)),n.config.withSeparableConvs?n.runMobilenet(o,r):n.runTinyYolov2(o,r)})},e.prototype.forward=function(t,e){return b(this,void 0,void 0,function(){var n;return y(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,td(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent()]}})})},e.prototype.detect=function(t,e){return void 0===e&&(e={}),b(this,void 0,void 0,function(){var n,r,o,i,a,s,c,u,f,h,p,d,v=this;return y(this,function(m){switch(m.label){case 0:return r=(n=new ep(e)).inputSize,o=n.scoreThreshold,[4,td(t)];case 1:return i=m.sent(),[4,this.forwardInput(i,r)];case 2:return a=m.sent(),s=l.lub(function(){return l.HHK(a)[0].expandDims()}),c={width:i.getInputWidth(0),height:i.getInputHeight(0)},[4,this.extractBoxes(s,i.getReshapedInputDimensions(0),o)];case 3:return u=m.sent(),a.dispose(),s.dispose(),f=u.map(function(t){return t.box}),h=u.map(function(t){return t.score}),p=u.map(function(t){return t.classScore}),d=u.map(function(t){return v.config.classes[t.label]}),[2,L(f.map(function(t){return t.rescale(r)}),h,this.config.iouThreshold,!0).map(function(t){return new A(h[t],p[t],d[t],f[t],c)})]}})})},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(t){return function(t,e){var n,r=[],o=function(t,e){var n=tB(t,e);function r(t){return{filters:n(t+"/filters",4),bias:n(t+"/bias",1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(t){var e;return{conv:r(t+"/conv"),bn:{sub:n((e=t+"/bn")+"/sub",1),truediv:n(e+"/truediv",1)}}},extractSeparableConvParams:tS(n)}}(t,r),i=o.extractConvParams,a=o.extractConvWithBatchNormParams,s=o.extractSeparableConvParams;if(e.withSeparableConvs){var c=e.filterSizes&&e.filterSizes.length||9;n={conv0:e.isFirstLayerConv2d?i("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:c>7?s("conv6"):void 0,conv7:c>8?s("conv7"):void 0,conv8:i("conv8")}}else n={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:i("conv8")};return tE(t,r),{params:n,paramMappings:r}}(t,this.config)},e.prototype.extractParams=function(t){var n=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return function(t,e,n,r){var o,i,a=tC(t),s=a.extractWeights,c=a.getRemainingWeights,u=[],f={extractConvParams:o=tM(s,u),extractConvWithBatchNormParams:function(t,e,n){var r,i,a;return{conv:o(t,e,3,n+"/conv"),bn:(r=n+"/bn",i=l.RRF(s(e)),a=l.RRF(s(e)),u.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:i,truediv:a})}},extractSeparableConvParams:tT(s,u)},h=f.extractConvParams,p=f.extractConvWithBatchNormParams,d=f.extractSeparableConvParams;if(e.withSeparableConvs){var v=r[0],m=r[1],g=r[2],b=r[3],y=r[4],_=r[5],w=r[6],x=r[7],P=r[8],E=e.isFirstLayerConv2d?h(v,m,3,"conv0"):d(v,m,"conv0"),M=d(m,g,"conv1"),F=d(g,b,"conv2"),I=d(b,y,"conv3"),T=d(y,_,"conv4"),S=d(_,w,"conv5"),B=x?d(w,x,"conv6"):void 0,C=P?d(x,P,"conv7"):void 0,D=h(P||x||w,5*n,1,"conv8");i={conv0:E,conv1:M,conv2:F,conv3:I,conv4:T,conv5:S,conv6:B,conv7:C,conv8:D}}else{var v=r[0],m=r[1],g=r[2],b=r[3],y=r[4],_=r[5],w=r[6],x=r[7],P=r[8],E=p(v,m,"conv0"),M=p(m,g,"conv1"),F=p(g,b,"conv2"),I=p(b,y,"conv3"),T=p(y,_,"conv4"),S=p(_,w,"conv5"),B=p(w,x,"conv6"),C=p(x,P,"conv7"),D=h(P,5*n,1,"conv8");i={conv0:E,conv1:M,conv2:F,conv3:I,conv4:T,conv5:S,conv6:B,conv7:C,conv8:D}}if(0!==c().length)throw Error("weights remaing after extract: "+c().length);return{params:i,paramMappings:u}}(t,this.config,this.boxEncodingSize,n)},e.prototype.extractBoxes=function(t,e,n){return b(this,void 0,void 0,function(){var r,o,i,a,s,c,u,f,h,p,d,v,m,b,_,w,x,P,E,M,F,I,T,S,B,C,A,O,L,k=this;return y(this,function(y){switch(y.label){case 0:return a=(i=Math.max(r=e.width,o=e.height))/r,s=i/o,c=t.shape[1],u=this.config.anchors.length,h=(f=l.lub(function(){var e=t.reshape([c,c,u,k.boxEncodingSize]);return[e.slice([0,0,0,0],[c,c,u,4]),e.slice([0,0,0,4],[c,c,u,1]),k.withClassScores?l.XAC(e.slice([0,0,0,5],[c,c,u,k.config.classes.length]),3):l.iD$(0)]}))[0],p=f[1],d=f[2],v=[],[4,p.array()];case 1:return m=y.sent(),[4,h.array()];case 2:b=y.sent(),_=0,y.label=3;case 3:if(!(_<c))return[3,12];w=0,y.label=4;case 4:if(!(w<c))return[3,11];x=0,y.label=5;case 5:if(!(x<u))return[3,10];if(P=R(m[_][w][x][0]),!(!n||P>n))return[3,9];if(E=(w+R(b[_][w][x][0]))/c*a,M=(_+R(b[_][w][x][1]))/c*s,F=Math.exp(b[_][w][x][2])*this.config.anchors[x].x/c*a,I=Math.exp(b[_][w][x][3])*this.config.anchors[x].y/c*s,T=E-F/2,S=M-I/2,B={row:_,col:w,anchor:x},!this.withClassScores)return[3,7];return[4,this.extractPredictedClass(d,B)];case 6:return L=y.sent(),[3,8];case 7:L={classScore:1,label:0},y.label=8;case 8:A=(C=L).classScore,O=C.label,v.push(g({box:new D(T,S,T+F,S+I),score:P,classScore:P*A,label:O},B)),y.label=9;case 9:return x++,[3,5];case 10:return w++,[3,4];case 11:return _++,[3,3];case 12:return h.dispose(),p.dispose(),d.dispose(),[2,v]}})})},e.prototype.extractPredictedClass=function(t,e){return b(this,void 0,void 0,function(){var n,r,o,i;return y(this,function(a){switch(a.label){case 0:return n=e.row,r=e.col,o=e.anchor,[4,t.array()];case 1:return i=a.sent(),[2,Array(this.config.classes.length).fill(0).map(function(t,e){return i[n][r][o][e]}).map(function(t,e){return{classScore:t,label:e}}).reduce(function(t,e){return t.classScore>e.classScore?t:e})]}})})},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(ty),ed=function(t){function e(e){void 0===e&&(e=!0);var n=Object.assign({},{withSeparableConvs:e,iouThreshold:.4,classes:["face"]},e?{anchors:ea,meanRgb:es}:{anchors:ei,withClassScores:!0});return t.call(this,n)||this}return m(e,t),Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return b(this,void 0,void 0,function(){return y(this,function(n){switch(n.label){case 0:return[4,this.detect(t,e)];case 1:return[2,n.sent().map(function(t){return new O(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(el),ev=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return m(e,t),e}(ep),em=function(){function t(){}return t.prototype.then=function(t){return b(this,void 0,void 0,function(){var e;return y(this,function(n){switch(n.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[n.sent()])]}})})},t.prototype.run=function(){return b(this,void 0,void 0,function(){return y(this,function(t){throw Error("ComposableTask - run is not implemented")})})},t}();function eg(t,e){return Object.assign({},t,{descriptor:e})}function eb(t,e,n,r,o){return void 0===o&&(o=function(t){return t.alignedRect}),b(this,void 0,void 0,function(){var i,a,s,c,u;return y(this,function(f){switch(f.label){case 0:if(i=t.map(function(t){return tY(t)?o(t):t.detection}),s=r)return[3,5];if(!(e instanceof l.esB))return[3,2];return[4,tm(e,i)];case 1:return c=f.sent(),[3,4];case 2:return[4,tv(e,i)];case 3:c=f.sent(),f.label=4;case 4:s=c,f.label=5;case 5:return[4,n(a=s)];case 6:return u=f.sent(),a.forEach(function(t){return t instanceof l.esB&&t.dispose()}),[2,u]}})})}function ey(t,e,n,r,o){return b(this,void 0,void 0,function(){var i=this;return y(this,function(a){return[2,eb([t],e,function(t){return b(i,void 0,void 0,function(){return y(this,function(e){return[2,n(t[0])]})})},r,o)]})})}function e_(t,e){return{height:Math.floor(e[0]*t),width:Math.floor(e[1]*t)}}var ew=function(t){function e(e,n,r,o){return t.call(this,{left:e,top:n,right:r,bottom:o},!0)||this}return m(e,t),e}(C);function ex(t){return l.lub(function(){return l.dC7(l.luU(t,l.iD$(127.5)),l.iD$(.0078125))})}function eP(t,e){return l.lub(function(){return l.IHx(l.UYe(t),l.dC7(e,l.W76(l.UYe(l.W76(t)))))})}function eE(t,e,n){return void 0===n&&(n=!1),l.lub(function(){var r=tP(t,e.conv1,"valid");return r=eP(r,e.prelu1_alpha),r=eP(r=tP(r=l._sB(r,n?[2,2]:[3,3],[2,2],"same"),e.conv2,"valid"),e.prelu2_alpha),r=eP(r=tP(r=n?r:l._sB(r,[3,3],[2,2],"valid"),e.conv3,"valid"),e.prelu3_alpha)})}function eM(t,e,n){var r=n.width,o=n.height;return b(this,void 0,void 0,function(){var n,i,a,s=this;return y(this,function(c){switch(c.label){case 0:return n=tn(t),[4,Promise.all(e.map(function(e){return b(s,void 0,void 0,function(){var r,o,i,a,s,c,u,f;return y(this,function(h){return o=(r=e.padAtBorders(t.height,t.width)).y,i=r.ey,a=r.x,s=r.ex,c=a-1,u=o-1,f=n.getImageData(c,u,s-c,i-u),[2,tt.isNodejs()?th(f):createImageBitmap(f)]})})}))];case 1:return i=c.sent(),a=[],i.forEach(function(t){var e=tn(tf({width:r,height:o}));e.drawImage(t,0,0,r,o);for(var n=e.getImageData(0,0,r,o).data,i=[],s=0;s<n.length;s+=4)i.push(n[s+2]),i.push(n[s+1]),i.push(n[s]);a.push(i)}),[2,a.map(function(t){return l.lub(function(){return ex(l.p4s(l.yXz(t,[1,r,o,3]),[0,2,1,3]).toFloat())})})]}})})}var eF=function(t){function e(){return t.call(this,"Mtcnn")||this}return m(e,t),e.prototype.load=function(e){return b(this,void 0,void 0,function(){return y(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.load.call(this,e)]})})},e.prototype.loadFromDisk=function(e){return b(this,void 0,void 0,function(){return y(this,function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.loadFromDisk.call(this,e)]})})},e.prototype.forwardInput=function(t,e){return void 0===e&&(e={}),b(this,void 0,void 0,function(){var n,r,o,i,a,s,c,u,f,h,p,d,v,m,g,_,w,x,P,E;return y(this,function(M){switch(M.label){case 0:if(!(n=this.params))throw Error("Mtcnn - load model before inference");if(!(r=t.canvases[0]))throw Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},i=Date.now(),a=l.lub(function(){var t;return t=l.dt4(l.Xhn.fromPixels(r)).toFloat(),l.lub(function(){return l.knu(l.HHK(t,3).reverse(),3)})}),s=function(t){return a.dispose(),o.total=Date.now()-i,t},u=(c=a.shape.slice(1))[0],f=c[1],p=(h=new et(e)).minFaceSize,d=h.scaleFactor,v=h.maxNumScales,m=h.scoreThresholds,g=(h.scaleSteps||function(t,e,n){for(var r=n[0],o=n[1],i=12/t,a=[],s=Math.min(r,o)*i,c=0;s>=12;)a.push(i*Math.pow(e,c)),s*=e,c+=1;return a}(p,d,[u,f])).filter(function(t){var e=e_(t,[u,f]);return Math.min(e.width,e.height)>12}).slice(0,v),o.scales=g,o.pyramid=g.map(function(t){return e_(t,[u,f])}),_=Date.now(),[4,function(t,e,n,r,o){o.stage1=[];var i=e.map(function(e){return l.lub(function(){var n={scale:e},o=l.lub(function(){var n=e_(e,t.shape.slice(1)),r=n.height,o=n.width,i=ex(l.BHj.resizeBilinear(t,[r,o]));return l.p4s(i,[0,2,1,3])}),i=Date.now(),a=l.lub(function(){var t=eE(o,r,!0),e=tP(t,r.conv4_1,"valid"),n=l.dt4(l.Fp7(e,3),3);return{prob:l.XAC(l.luU(e,n),3),regions:tP(t,r.conv4_2,"valid")}}),s=a.prob,c=a.regions;return n.pnet=Date.now()-i,{scoresTensor:l.HHK(l.HHK(s,3)[1])[0],regionsTensor:l.HHK(c)[0],scale:e,statsForScale:n}})}).map(function(t){var e=t.scoresTensor,r=t.regionsTensor,i=t.scale,a=t.statsForScale,s=function(t,e,n,r){for(var o=[],i=t.arraySync(),a=0;a<t.shape[0];a++)for(var s=0;s<t.shape[1];s++)i[a][s]>=r&&o.push(new B(s,a));return o.map(function(t){var r=new D(Math.round((2*t.y+1)/n),Math.round((2*t.x+1)/n),Math.round((2*t.y+12)/n),Math.round((2*t.x+12)/n)),o=i[t.y][t.x],a=e.arraySync();return{cell:r,score:o,region:new ew(a[t.y][t.x][0],a[t.y][t.x][1],a[t.y][t.x][2],a[t.y][t.x][3])}})}(e,r,i,n);if(e.dispose(),r.dispose(),!s.length)return o.stage1.push(a),[];var c=Date.now(),u=L(s.map(function(t){return t.cell}),s.map(function(t){return t.score}),.5);return a.nms=Date.now()-c,a.numBoxes=u.length,o.stage1.push(a),u.map(function(t){return s[t]})}).reduce(function(t,e){return t.concat(e)},[]),a=[],s=[];if(i.length>0){var c=Date.now(),u=L(i.map(function(t){return t.cell}),i.map(function(t){return t.score}),.7);o.stage1_nms=Date.now()-c,s=u.map(function(t){return i[t].score}),a=u.map(function(t){return i[t]}).map(function(t){var e=t.cell,n=t.region;return new D(e.left+n.left*e.width,e.top+n.top*e.height,e.right+n.right*e.width,e.bottom+n.bottom*e.height).toSquare().round()})}return{boxes:a,scores:s}}(a,g,m[0],n.pnet,o)];case 1:if(w=M.sent(),o.total_stage1=Date.now()-_,!w.boxes.length)return[2,s({results:[],stats:o})];return o.stage2_numInputBoxes=w.boxes.length,_=Date.now(),[4,function(t,e,n,r,o){return b(this,void 0,void 0,function(){var i,a,s,c,u,f,h,p,d,v,m,g,b,_;return y(this,function(y){switch(y.label){case 0:return i=Date.now(),[4,eM(t,e,{width:24,height:24})];case 1:return a=y.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(t){var e=l.lub(function(){var e=eE(t,r),n=eP(tk(l.XLQ(e,[e.shape[0],r.fc1.weights.shape[0]]),r.fc1),r.prelu4_alpha),o=tk(n,r.fc2_1),i=l.dt4(l.Fp7(o,1),1),a=l.XAC(l.luU(o,i),1),s=tk(n,r.fc2_2);return{scores:l.HHK(a,1)[1],regions:s}});return t.dispose(),e}),o.stage2_rnet=Date.now()-i,c=s.length>1?l.zoF(s.map(function(t){return t.scores})):s[0].scores,h=(f=Array).from,[4,c.data()];case 2:return u=h.apply(f,[y.sent()]),c.dispose(),d=(p=u.map(function(t,e){return{score:t,idx:e}}).filter(function(t){return t.score>n}).map(function(t){return t.idx})).map(function(t){return e[t]}),v=p.map(function(t){return u[t]}),m=[],g=[],d.length>0&&(i=Date.now(),b=L(d,v,.7),o.stage2_nms=Date.now()-i,_=b.map(function(t){var e=s[p[t]].regions.arraySync();return new ew(e[0][0],e[0][1],e[0][2],e[0][3])}),g=b.map(function(t){return v[t]}),m=b.map(function(t,e){return d[t].calibrate(_[e])})),s.forEach(function(t){t.regions.dispose(),t.scores.dispose()}),[2,{boxes:m,scores:g}]}})})}(r,w.boxes,m[1],n.rnet,o)];case 2:if(x=M.sent(),o.total_stage2=Date.now()-_,!x.boxes.length)return[2,s({results:[],stats:o})];return o.stage3_numInputBoxes=x.boxes.length,_=Date.now(),[4,function(t,e,n,r,o){return b(this,void 0,void 0,function(){var i,a,s,c,u,f,h,p,d,v,m,g,b,_,w;return y(this,function(y){switch(y.label){case 0:return i=Date.now(),[4,eM(t,e,{width:48,height:48})];case 1:return a=y.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(t){var e=l.lub(function(){var e=eE(t,r);e=eP(e=tP(e=l._sB(e,[2,2],[2,2],"same"),r.conv4,"valid"),r.prelu4_alpha);var n=eP(tk(l.XLQ(e,[e.shape[0],r.fc1.weights.shape[0]]),r.fc1),r.prelu5_alpha),o=tk(n,r.fc2_1),i=l.dt4(l.Fp7(o,1),1),a=l.XAC(l.luU(o,i),1),s=tk(n,r.fc2_2),c=tk(n,r.fc2_3);return{scores:l.HHK(a,1)[1],regions:s,points:c}});return t.dispose(),e}),o.stage3_onet=Date.now()-i,c=s.length>1?l.zoF(s.map(function(t){return t.scores})):s[0].scores,h=(f=Array).from,[4,c.data()];case 2:return u=h.apply(f,[y.sent()]),c.dispose(),d=(p=u.map(function(t,e){return{score:t,idx:e}}).filter(function(t){return t.score>n}).map(function(t){return t.idx})).map(function(t){var e=s[t].regions.arraySync();return new ew(e[0][0],e[0][1],e[0][2],e[0][3])}),v=p.map(function(t,n){return e[t].calibrate(d[n])}),m=p.map(function(t){return u[t]}),g=[],b=[],_=[],v.length>0&&(i=Date.now(),w=L(v,m,.7,!1),o.stage3_nms=Date.now()-i,g=w.map(function(t){return v[t]}),b=w.map(function(t){return m[t]}),_=w.map(function(t,e){return[,,,,,].fill(0).map(function(n,r){var o=s[t].points.arraySync();return new B(o[0][r]*(g[e].width+1)+g[e].left,o[0][r+5]*(g[e].height+1)+g[e].top)})})),s.forEach(function(t){t.regions.dispose(),t.scores.dispose(),t.points.dispose()}),[2,{boxes:g,scores:b,points:_}]}})})}(r,x.boxes,m[2],n.onet,o)];case 3:return P=M.sent(),o.total_stage3=Date.now()-_,E=P.boxes.map(function(t,e){return tX(G({},new O(P.scores[e],new j(t.left/f,t.top/u,t.width/f,t.height/u),{height:u,width:f})),new H(P.points[e].map(function(e){return e.sub(new B(t.left,t.top)).div(new B(t.width,t.height))}),{width:t.width,height:t.height}))}),[2,s({results:E,stats:o})]}})})},e.prototype.forward=function(t,e){return void 0===e&&(e={}),b(this,void 0,void 0,function(){var n;return y(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,td(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent().results]}})})},e.prototype.forwardWithStats=function(t,e){return void 0===e&&(e={}),b(this,void 0,void 0,function(){var n;return y(this,function(r){switch(r.label){case 0:return n=this.forwardInput,[4,td(t)];case 1:return[2,n.apply(this,[r.sent(),e])]}})})},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(t){var e,n,r,o,i,a,s,c;return r=(n=function(t,e){var n=tB(t,e);function r(t){return{filters:n(t+"/weights",4,t+"/filters"),bias:n(t+"/bias",1)}}function o(t){return{weights:n(t+"/weights",2),bias:n(t+"/bias",1)}}function i(t){return{conv1:r(t+"/conv1"),prelu1_alpha:n(t+"/prelu1_alpha",1),conv2:r(t+"/conv2"),prelu2_alpha:n(t+"/prelu2_alpha",1),conv3:r(t+"/conv3"),prelu3_alpha:n(t+"/prelu3_alpha",1)}}return{extractPNetParams:function(){var t=i("pnet"),e=r("pnet/conv4_1"),n=r("pnet/conv4_2");return g(g({},t),{conv4_1:e,conv4_2:n})},extractRNetParams:function(){var t=i("rnet"),e=o("rnet/fc1"),r=n("rnet/prelu4_alpha",1),a=o("rnet/fc2_1"),s=o("rnet/fc2_2");return g(g({},t),{fc1:e,prelu4_alpha:r,fc2_1:a,fc2_2:s})},extractONetParams:function(){var t=i("onet"),e=r("onet/conv4"),a=n("onet/prelu4_alpha",1),s=o("onet/fc1"),c=n("onet/prelu5_alpha",1),u=o("onet/fc2_1"),f=o("onet/fc2_2"),h=o("onet/fc2_3");return g(g({},t),{conv4:e,prelu4_alpha:a,fc1:s,prelu5_alpha:c,fc2_1:u,fc2_2:f,fc2_3:h})}}}(t,e=[])).extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),c=i(),tE(t,e),{params:{pnet:a,rnet:s,onet:c},paramMappings:e}},e.prototype.extractParams=function(t){return function(t){var e=tC(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],i=function(t,e){var n=tM(t,e),r=tF(t,e);function o(n,r){var o=l.RRF(t(n));return e.push({paramPath:r}),o}function i(t,e,r){return void 0===r&&(r=!1),{conv1:n(t[0],t[1],3,e+"/conv1"),prelu1_alpha:o(t[1],e+"/prelu1_alpha"),conv2:n(t[1],t[2],3,e+"/conv2"),prelu2_alpha:o(t[2],e+"/prelu2_alpha"),conv3:n(t[2],t[3],r?2:3,e+"/conv3"),prelu3_alpha:o(t[3],e+"/prelu3_alpha")}}return{extractPNetParams:function(){var t=i([3,10,16,32],"pnet"),e=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return g(g({},t),{conv4_1:e,conv4_2:r})},extractRNetParams:function(){var t=i([3,28,48,64],"rnet",!0),e=r(576,128,"rnet/fc1"),n=o(128,"rnet/prelu4_alpha"),a=r(128,2,"rnet/fc2_1"),s=r(128,4,"rnet/fc2_2");return g(g({},t),{fc1:e,prelu4_alpha:n,fc2_1:a,fc2_2:s})},extractONetParams:function(){var t=i([3,32,64,64],"onet"),e=n(64,128,2,"onet/conv4"),a=o(128,"onet/prelu4_alpha"),s=r(1152,256,"onet/fc1"),c=o(256,"onet/prelu5_alpha"),u=r(256,2,"onet/fc2_1"),f=r(256,4,"onet/fc2_2"),h=r(256,10,"onet/fc2_3");return g(g({},t),{conv4:e,prelu4_alpha:a,fc1:s,prelu5_alpha:c,fc2_1:u,fc2_2:f,fc2_3:h})}}}(n,o),a=i.extractPNetParams,s=i.extractRNetParams,c=i.extractONetParams,u=a(),f=s(),h=c();if(0!==r().length)throw Error("weights remaing after extract: "+r().length);return{params:{pnet:u,rnet:f,onet:h},paramMappings:o}}(t)},e}(ty),eI=[new B(1.603231,2.094468),new B(6.041143,7.080126),new B(2.882459,3.518061),new B(4.266906,5.178857),new B(9.041765,10.66308)],eT=[117.001,114.697,97.404],eS=function(t){function e(){return t.call(this,{withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:eI,meanRgb:eT,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})||this}return m(e,t),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return b(this,void 0,void 0,function(){return y(this,function(n){switch(n.label){case 0:return[4,this.detect(t,e)];case 1:return[2,n.sent().map(function(t){return new O(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})})]}})})},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(el),eB={ssdMobilenetv1:new eo,tinyFaceDetector:new eS,tinyYolov2:new ed,mtcnn:new eF,faceLandmark68Net:new t0,faceLandmark68TinyNet:new t2,faceRecognitionNet:new t7,faceExpressionNet:new tU,ageGenderNet:new tQ};function eC(t,e){return Object.assign({},t,{age:e})}var eD=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parentTask=e,o.input=n,o.extractedFaces=r,o}return m(e,t),e}(em),eA=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.run=function(){return b(this,void 0,void 0,function(){var t,e,n=this;return y(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,eb(t=r.sent(),this.input,function(t){return b(n,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,Promise.all(t.map(function(t){return eB.faceExpressionNet.predictExpressions(t)}))];case 1:return[2,e.sent()]}})})},this.extractedFaces)];case 2:return e=r.sent(),[2,t.map(function(t,n){return tz(t,e[n])})]}})})},e.prototype.withAgeAndGender=function(){return new ej(this,this.input)},e}(eD),eO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.run=function(){return b(this,void 0,void 0,function(){var t,e;return y(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:if(!(t=n.sent()))return[2];return[4,ey(t,this.input,function(t){return eB.faceExpressionNet.predictExpressions(t)},this.extractedFaces)];case 2:return e=n.sent(),[2,tz(t,e)]}})})},e.prototype.withAgeAndGender=function(){return new eN(this,this.input)},e}(eD),eL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.withAgeAndGender=function(){return new eH(this,this.input)},e.prototype.withFaceDescriptors=function(){return new eW(this,this.input)},e}(eA),ek=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.withAgeAndGender=function(){return new eU(this,this.input)},e.prototype.withFaceDescriptor=function(){return new eY(this,this.input)},e}(eO),eR=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parentTask=e,o.input=n,o.extractedFaces=r,o}return m(e,t),e}(em),ej=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.run=function(){return b(this,void 0,void 0,function(){var t,e,n=this;return y(this,function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,eb(t=r.sent(),this.input,function(t){return b(n,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,Promise.all(t.map(function(t){return eB.ageGenderNet.predictAgeAndGender(t)}))];case 1:return[2,e.sent()]}})})},this.extractedFaces)];case 2:return e=r.sent(),[2,t.map(function(t,n){var r=e[n],o=r.age;return eC(t9(t,r.gender,r.genderProbability),o)})]}})})},e.prototype.withFaceExpressions=function(){return new eA(this,this.input)},e}(eR),eN=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.run=function(){return b(this,void 0,void 0,function(){var t,e,n,r,o;return y(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:if(!(t=i.sent()))return[2];return[4,ey(t,this.input,function(t){return eB.ageGenderNet.predictAgeAndGender(t)},this.extractedFaces)];case 2:return n=(e=i.sent()).age,r=e.gender,o=e.genderProbability,[2,eC(t9(t,r,o),n)]}})})},e.prototype.withFaceExpressions=function(){return new eO(this,this.input)},e}(eR),eH=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.withFaceExpressions=function(){return new eL(this,this.input)},e.prototype.withFaceDescriptors=function(){return new eW(this,this.input)},e}(ej),eU=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.withFaceExpressions=function(){return new ek(this,this.input)},e.prototype.withFaceDescriptor=function(){return new eY(this,this.input)},e}(eN),ez=function(t){function e(e,n){var r=t.call(this)||this;return r.parentTask=e,r.input=n,r}return m(e,t),e}(em),eW=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.run=function(){return b(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:return[4,this.parentTask];case 1:return[4,eb(t=e.sent(),this.input,function(t){return Promise.all(t.map(function(t){return eB.faceRecognitionNet.computeFaceDescriptor(t)}))},null,function(t){return t.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return[2,e.sent().map(function(e,n){return eg(t[n],e)})]}})})},e.prototype.withFaceExpressions=function(){return new eL(this,this.input)},e.prototype.withAgeAndGender=function(){return new eH(this,this.input)},e}(ez),eY=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.run=function(){return b(this,void 0,void 0,function(){var t,e;return y(this,function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:if(!(t=n.sent()))return[2];return[4,ey(t,this.input,function(t){return eB.faceRecognitionNet.computeFaceDescriptor(t)},null,function(t){return t.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return e=n.sent(),[2,eg(t,e)]}})})},e.prototype.withFaceExpressions=function(){return new ek(this,this.input)},e.prototype.withAgeAndGender=function(){return new eU(this,this.input)},e}(ez),eX=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parentTask=e,o.input=n,o.useTinyLandmarkNet=r,o}return m(e,t),Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?eB.faceLandmark68TinyNet:eB.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(em),eG=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.run=function(){return b(this,void 0,void 0,function(){var t,e,n,r,o,i=this;return y(this,function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:if(e=(t=a.sent()).map(function(t){return t.detection}),!(this.input instanceof l.esB))return[3,3];return[4,tm(this.input,e)];case 2:return r=a.sent(),[3,5];case 3:return[4,tv(this.input,e)];case 4:r=a.sent(),a.label=5;case 5:return[4,Promise.all((n=r).map(function(t){return i.landmarkNet.detectLandmarks(t)}))];case 6:return o=a.sent(),n.forEach(function(t){return t instanceof l.esB&&t.dispose()}),[2,t.map(function(t,e){return tX(t,o[e])})]}})})},e.prototype.withFaceExpressions=function(){return new eL(this,this.input)},e.prototype.withAgeAndGender=function(){return new eH(this,this.input)},e.prototype.withFaceDescriptors=function(){return new eW(this,this.input)},e}(eX),eV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.run=function(){return b(this,void 0,void 0,function(){var t,e,n,r,o;return y(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:if(!(t=i.sent()))return[2];if(e=t.detection,!(this.input instanceof l.esB))return[3,3];return[4,tm(this.input,[e])];case 2:return r=i.sent(),[3,5];case 3:return[4,tv(this.input,[e])];case 4:r=i.sent(),i.label=5;case 5:return n=r,[4,this.landmarkNet.detectLandmarks(n[0])];case 6:return o=i.sent(),n.forEach(function(t){return t instanceof l.esB&&t.dispose()}),[2,tX(t,o)]}})})},e.prototype.withFaceExpressions=function(){return new ek(this,this.input)},e.prototype.withAgeAndGender=function(){return new eU(this,this.input)},e.prototype.withFaceDescriptor=function(){return new eY(this,this.input)},e}(eX),e$=function(t){function e(e,n){void 0===n&&(n=new er);var r=t.call(this)||this;return r.input=e,r.options=n,r}return m(e,t),e}(em),eJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.run=function(){return b(this,void 0,void 0,function(){var t,e,n,r;return y(this,function(o){switch(o.label){case 0:if(t=this,e=t.input,!((n=t.options)instanceof et))return[3,2];return[4,eB.mtcnn.forward(e,n)];case 1:return[2,o.sent().map(function(t){return t.detection})];case 2:if(!(r=n instanceof ev?function(t){return eB.tinyFaceDetector.locateFaces(t,n)}:n instanceof er?function(t){return eB.ssdMobilenetv1.locateFaces(t,n)}:n instanceof ep?function(t){return eB.tinyYolov2.locateFaces(t,n)}:null))throw Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(e)]}})})},e.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise(function(e){return b(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.run()];case 1:return[2,e(t.sent().map(function(t){return G({},t)}))]}})})})},e.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new eG(this.runAndExtendWithFaceDetections(),this.input,t)},e.prototype.withFaceExpressions=function(){return new eA(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new ej(this.runAndExtendWithFaceDetections(),this.input)},e}(e$),eK=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.run=function(){return b(this,void 0,void 0,function(){var t,e;return y(this,function(n){switch(n.label){case 0:return[4,new eJ(this.input,this.options)];case 1:return e=(t=n.sent())[0],t.forEach(function(t){t.score>e.score&&(e=t)}),[2,e]}})})},e.prototype.runAndExtendWithFaceDetection=function(){var t=this;return new Promise(function(e){return b(t,void 0,void 0,function(){var t;return y(this,function(n){switch(n.label){case 0:return[4,this.run()];case 1:return[2,e((t=n.sent())?G({},t):void 0)]}})})})},e.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new eV(this.runAndExtendWithFaceDetection(),this.input,t)},e.prototype.withFaceExpressions=function(){return new eO(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new eN(this.runAndExtendWithFaceDetection(),this.input)},e}(e$);function eq(t,e){return void 0===e&&(e=new er),new eK(t,e)}function eQ(t,e){return void 0===e&&(e=new er),new eJ(t,e)}function eZ(t,e){if(t.length!==e.length)throw Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(t),r=Array.from(e);return Math.sqrt(n.map(function(t,e){return t-r[e]}).reduce(function(t,e){return t+Math.pow(e,2)},0))}!function(){function t(t,e){void 0===e&&(e=.6),this._distanceThreshold=e;var n=Array.isArray(t)?t:[t];if(!n.length)throw Error("FaceRecognizer.constructor - expected atleast one input");var r=1,o=function(){return"person "+r++};this._labeledDescriptors=n.map(function(t){if(t instanceof Y)return t;if(t instanceof Float32Array)return new Y(o(),[t]);if(t.descriptor&&t.descriptor instanceof Float32Array)return new Y(o(),[t.descriptor]);throw Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}Object.defineProperty(t.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),t.prototype.computeMeanDistance=function(t,e){return e.map(function(e){return eZ(e,t)}).reduce(function(t,e){return t+e},0)/(e.length||1)},t.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map(function(n){var r=n.descriptors;return new z(n.label,e.computeMeanDistance(t,r))}).reduce(function(t,e){return t.distance<e.distance?t:e})},t.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new z("unknown",e.distance)},t.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},t.fromJSON=function(e){return new t(e.labeledDescriptors.map(function(t){return Y.fromJSON(t)}),e.distanceThreshold)}}()},263:function(t){!function(){var e={675:function(t,e){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return(n+r)*3/4-r},e.toByteArray=function(t){var e,n,i=c(t),a=i[0],s=i[1],u=new o((a+s)*3/4-s),f=0,h=s>0?a-4:a;for(n=0;n<h;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],u[f++]=e>>16&255,u[f++]=e>>8&255,u[f++]=255&e;return 2===s&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,u[f++]=255&e),1===s&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,u[f++]=e>>8&255,u[f++]=255&e),u},e.fromByteArray=function(t){for(var e,r=t.length,o=r%3,i=[],a=0,s=r-o;a<s;a+=16383)i.push(function(t,e,r){for(var o,i=[],a=e;a<r;a+=3)i.push(n[(o=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]))>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return i.join("")}(t,a,a+16383>s?s:a+16383));return 1===o?i.push(n[(e=t[r-1])>>2]+n[e<<4&63]+"=="):2===o&&i.push(n[(e=(t[r-2]<<8)+t[r-1])>>10]+n[e>>4&63]+n[e<<2&63]+"="),i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=i.length;a<s;++a)n[a]=i[a],r[i.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");-1===n&&(n=e);var r=n===e?0:4-n%4;return[n,r]}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},72:function(t,e,n){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var r=n(675),o=n(783),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function a(t){if(t>2147483647)throw RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,n){if("number"==typeof t){if("string"==typeof e)throw TypeError('The "string" argument must be of type string. Received type number');return f(t)}return c(t,e,n)}function c(t,e,n){if("string"==typeof t)return function(t,e){if(("string"!=typeof e||""===e)&&(e="utf8"),!s.isEncoding(e))throw TypeError("Unknown encoding: "+e);var n=0|l(t,e),r=a(n),o=r.write(t,e);return o!==n&&(r=r.slice(0,o)),r}(t,e);if(ArrayBuffer.isView(t))return h(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(S(t,ArrayBuffer)||t&&S(t.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(S(t,SharedArrayBuffer)||t&&S(t.buffer,SharedArrayBuffer)))return function(t,e,n){var r;if(e<0||t.byteLength<e)throw RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),s.prototype),r}(t,e,n);if("number"==typeof t)throw TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return s.from(r,e,n);var o=function(t){if(s.isBuffer(t)){var e,n=0|p(t.length),r=a(n);return 0===r.length||t.copy(r,0,0,n),r}return void 0!==t.length?"number"!=typeof t.length||(e=t.length)!=e?a(0):h(t):"Buffer"===t.type&&Array.isArray(t.data)?h(t.data):void 0}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw TypeError('"size" argument must be of type number');if(t<0)throw RangeError('The value "'+t+'" is invalid for option "size"')}function f(t){return u(t),a(t<0?0:0|p(t))}function h(t){for(var e=t.length<0?0:0|p(t.length),n=a(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function p(t){if(t>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|t}function l(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||S(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return M(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(t).length;default:if(o)return r?-1:M(t).length;e=(""+e).toLowerCase(),o=!0}}function d(t,e,n){var o,i,a=!1;if((void 0===e||e<0)&&(e=0),e>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(e>>>=0)))return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=B[t[i]];return o}(this,e,n);case"utf8":case"utf-8":return b(this,e,n);case"ascii":return function(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}(this,e,n);case"latin1":case"binary":return function(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}(this,e,n);case"base64":return o=e,i=n,0===o&&i===this.length?r.fromByteArray(this):r.fromByteArray(this.slice(o,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}(this,e,n);default:if(a)throw TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),a=!0}}function v(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,o){var i;if(0===t.length)return -1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),(i=n=+n)!=i&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return -1;n=t.length-1}else if(n<0){if(!o)return -1;n=0}if("string"==typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,o);if("number"==typeof e)return(e&=255,"function"==typeof Uint8Array.prototype.indexOf)?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,o);throw TypeError("val must be string, number or Buffer")}function g(t,e,n,r,o){var i,a=1,s=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return -1;a=2,s/=2,c/=2,n/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(o){var f=-1;for(i=n;i<s;i++)if(u(t,i)===u(e,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===c)return f*a}else -1!==f&&(i-=i-f),f=-1}else for(n+c>s&&(n=s-c),i=n;i>=0;i--){for(var h=!0,p=0;p<c;p++)if(u(t,i+p)!==u(e,p)){h=!1;break}if(h)return i}return -1}function b(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,a,s,c,u=t[o],f=null,h=u>239?4:u>223?3:u>191?2:1;if(o+h<=n)switch(h){case 1:u<128&&(f=u);break;case 2:(192&(i=t[o+1]))==128&&(c=(31&u)<<6|63&i)>127&&(f=c);break;case 3:i=t[o+1],a=t[o+2],(192&i)==128&&(192&a)==128&&(c=(15&u)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:i=t[o+1],a=t[o+2],s=t[o+3],(192&i)==128&&(192&a)==128&&(192&s)==128&&(c=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(f=c)}null===f?(f=65533,h=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),o+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}function y(t,e,n){if(t%1!=0||t<0)throw RangeError("offset is not uint");if(t+e>n)throw RangeError("Trying to access beyond buffer length")}function _(t,e,n,r,o,i){if(!s.isBuffer(t))throw TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw RangeError('"value" argument is out of bounds');if(n+r>t.length)throw RangeError("Index out of range")}function w(t,e,n,r,o,i){if(n+r>t.length||n<0)throw RangeError("Index out of range")}function x(t,e,n,r,i){return e=+e,n>>>=0,i||w(t,e,n,4,34028234663852886e22,-34028234663852886e22),o.write(t,e,n,r,23,4),n+4}function P(t,e,n,r,i){return e=+e,n>>>=0,i||w(t,e,n,8,17976931348623157e292,-17976931348623157e292),o.write(t,e,n,r,52,8),n+8}e.Buffer=s,e.SlowBuffer=function(t){return+t!=t&&(t=0),s.alloc(+t)},e.INSPECT_MAX_BYTES=50,e.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,n){return c(t,e,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,n){return(u(t),t<=0)?a(t):void 0!==e?"string"==typeof n?a(t).fill(e,n):a(t).fill(e):a(t)},s.allocUnsafe=function(t){return f(t)},s.allocUnsafeSlow=function(t){return f(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(S(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),S(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);if(void 0===e)for(n=0,e=0;n<t.length;++n)e+=t[n].length;var n,r=s.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var i=t[n];if(S(i,Uint8Array)&&(i=s.from(i)),!s.isBuffer(i))throw TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},s.byteLength=l,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)v(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)v(this,e,e+3),v(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)v(this,e,e+7),v(this,e+1,e+6),v(this,e+2,e+5),v(this,e+3,e+4);return this},s.prototype.toString=function(){var t=this.length;return 0===t?"":0==arguments.length?b(this,0,t):d.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},i&&(s.prototype[i]=s.prototype.inspect),s.prototype.compare=function(t,e,n,r,o){if(S(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return -1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,o>>>=0,this===t)return 0;for(var i=o-r,a=n-e,c=Math.min(i,a),u=this.slice(r,o),f=t.slice(e,n),h=0;h<c;++h)if(u[h]!==f[h]){i=u[h],a=f[h];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(t,e,n){return -1!==this.indexOf(t,e,n)},s.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else if(isFinite(e))e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o,i,a,s,c,u,f,h,p,l,d,v,m=this.length-e;if((void 0===n||n>m)&&(n=m),t.length>0&&(n<0||e<0)||e>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var g=!1;;)switch(r){case"hex":return function(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(s!=s)break;t[n+a]=s}return a}(this,t,e,n);case"utf8":case"utf-8":return c=e,u=n,T(M(t,this.length-c),this,c,u);case"ascii":return f=e,h=n,T(F(t),this,f,h);case"latin1":case"binary":;return o=this,i=t,a=e,s=n,T(F(i),o,a,s);case"base64":return p=e,l=n,T(I(t),this,p,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d=e,v=n,T(function(t,e){for(var n,r,o=[],i=0;i<t.length&&!((e-=2)<0);++i)r=(n=t.charCodeAt(i))>>8,o.push(n%256),o.push(r);return o}(t,this.length-d),this,d,v);default:if(g)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),g=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||y(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},s.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||y(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},s.prototype.readUInt8=function(t,e){return t>>>=0,e||y(t,1,this.length),this[t]},s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||y(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||y(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||y(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||y(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||y(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},s.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||y(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},s.prototype.readInt8=function(t,e){return(t>>>=0,e||y(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||y(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){t>>>=0,e||y(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||y(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||y(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return t>>>=0,e||y(t,4,this.length),o.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||y(t,4,this.length),o.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||y(t,8,this.length),o.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||y(t,8,this.length),o.read(this,t,!1,52,8)},s.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){var o=Math.pow(2,8*n)-1;_(this,t,e,n,o,0)}var i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},s.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){var o=Math.pow(2,8*n)-1;_(this,t,e,n,o,0)}var i=n-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+n},s.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var o=Math.pow(2,8*n-1);_(this,t,e,n,o-1,-o)}var i=0,a=1,s=0;for(this[e]=255&t;++i<n&&(a*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+n},s.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var o=Math.pow(2,8*n-1);_(this,t,e,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[e+i]=255&t;--i>=0&&(a*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||_(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeFloatLE=function(t,e,n){return x(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return x(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return P(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return P(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(!s.isBuffer(t))throw TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n||0===t.length||0===this.length)return 0;if(e<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o=r-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,r);else if(this===t&&n<e&&e<r)for(var i=o-1;i>=0;--i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,r),e);return o},s.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===t.length){var o,i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw RangeError("Out of range index");if(n<=e)return this;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=s.isBuffer(t)?t:s.from(t,r),c=a.length;if(0===c)throw TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=a[o%c]}return this};var E=/[^+/0-9A-Za-z-_]/g;function M(t,e){e=e||1/0;for(var n,r=t.length,o=null,i=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319||a+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return i}function F(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function I(t){return r.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(E,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function T(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length)&&!(o>=t.length);++o)e[o+n]=t[o];return o}function S(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}var B=function(){for(var t="0123456789abcdef",e=Array(256),n=0;n<16;++n)for(var r=16*n,o=0;o<16;++o)e[r+o]=t[n]+t[o];return e}()},783:function(t,e){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */e.read=function(t,e,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,u=c>>1,f=-7,h=n?o-1:0,p=n?-1:1,l=t[e+h];for(h+=p,i=l&(1<<-f)-1,l>>=-f,f+=s;f>0;i=256*i+t[e+h],h+=p,f-=8);for(a=i&(1<<-f)-1,i>>=-f,f+=r;f>0;a=256*a+t[e+h],h+=p,f-=8);if(0===i)i=1-u;else{if(i===c)return a?NaN:1/0*(l?-1:1);a+=Math.pow(2,r),i-=u}return(l?-1:1)*a*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var a,s,c,u=8*i-o-1,f=(1<<u)-1,h=f>>1,p=23===o?5960464477539062e-23:0,l=r?0:i-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(isNaN(e=Math.abs(e))||e===1/0?(s=isNaN(e)?1:0,a=f):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+h>=1?e+=p/c:e+=p*Math.pow(2,1-h),e*c>=2&&(a++,c/=2),a+h>=f?(s=0,a=f):a+h>=1?(s=(e*c-1)*Math.pow(2,o),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,o),a=0));o>=8;t[n+l]=255&s,l+=d,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;t[n+l]=255&a,l+=d,a/=256,u-=8);t[n+l-d]|=128*v}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}},a=!0;try{e[t](i,i.exports,r),a=!1}finally{a&&delete n[t]}return i.exports}r.ab="//";var o=r(72);t.exports=o}()}}]);