(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[881],{5514:function(e,t,r){Promise.resolve().then(r.bind(r,377))},377:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var s=r(7437),a=r(2265),n=r(4482),o=r(1011);function l(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)([]),[i,d]=(0,a.useState)(!0),[c,m]=(0,a.useState)("today"),[x,u]=(0,a.useState)("");(0,a.useEffect)(()=>{h();let e=setInterval(h,3e4);return()=>clearInterval(e)},[]);let h=async()=>{try{d(!0);let[e,r]=await Promise.all([(0,n.zI)(100),(0,n.mU)()]);t(e),l(r)}catch(e){console.error("Error fetching attendance:",e)}finally{d(!1)}},p=()=>{let t="today"===c?r:e;return x?t.filter(e=>e.userName.toLowerCase().includes(x.toLowerCase())||e.userId.toLowerCase().includes(x.toLowerCase())):t},g=e=>{let t={present:"bg-green-100 text-green-800 border-green-200",late:"bg-yellow-100 text-yellow-800 border-yellow-200",absent:"bg-red-100 text-red-800 border-red-200"};return t[e]||t.present},f={total:r.length,present:r.filter(e=>"present"===e.status).length,late:r.filter(e=>"late"===e.status).length,absent:r.filter(e=>"absent"===e.status).length};return(0,s.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden mb-6",children:[(0,s.jsxs)("div",{className:"bg-gradient-to-r from-purple-500 to-pink-600 p-6",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-white",children:"Attendance Dashboard"}),(0,s.jsx)("p",{className:"text-white/80 mt-2",children:"Track and manage employee attendance records"})]}),(0,s.jsxs)("div",{className:"p-6 grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl border border-blue-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-blue-600 text-sm font-medium",children:"Total Today"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:f.total})]}),(0,s.jsx)("div",{className:"bg-blue-500/10 p-3 rounded-lg",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]})}),(0,s.jsx)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl border border-green-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-green-600 text-sm font-medium",children:"Present"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-green-900",children:f.present})]}),(0,s.jsx)("div",{className:"bg-green-500/10 p-3 rounded-lg",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),(0,s.jsx)("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 p-4 rounded-xl border border-yellow-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-yellow-600 text-sm font-medium",children:"Late"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:f.late})]}),(0,s.jsx)("div",{className:"bg-yellow-500/10 p-3 rounded-lg",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),(0,s.jsx)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-xl border border-red-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-red-600 text-sm font-medium",children:"Absent"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-red-900",children:f.absent})]}),(0,s.jsx)("div",{className:"bg-red-500/10 p-3 rounded-lg",children:(0,s.jsx)("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>m("today"),className:"px-4 py-2 rounded-lg font-medium transition-all duration-200 ".concat("today"===c?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Today"}),(0,s.jsx)("button",{onClick:()=>m("all"),className:"px-4 py-2 rounded-lg font-medium transition-all duration-200 ".concat("all"===c?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"All Records"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search by name...",value:x,onChange:e=>u(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,s.jsx)("svg",{className:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,s.jsx)("button",{onClick:h,className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200",title:"Refresh",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:i?(0,s.jsx)("div",{className:"p-12 text-center",children:(0,s.jsxs)("div",{className:"inline-flex items-center gap-3",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,s.jsx)("span",{className:"text-gray-600",children:"Loading attendance records..."})]})}):0===p().length?(0,s.jsxs)("div",{className:"p-12 text-center",children:[(0,s.jsx)("svg",{className:"w-16 h-16 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,s.jsx)("p",{className:"text-gray-500",children:"No attendance records found"})]}):(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Confidence"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200",children:p().map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-semibold",children:e.userName.charAt(0).toUpperCase()}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.userName}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.userId})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,o.p6)(e.timestamp)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,o.mr)(e.timestamp)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full border ".concat(g(e.status)),children:e.status})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.confidence?"".concat(Math.round(100*e.confidence),"%"):"N/A"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.location||"Main Office"})]},e.id))})]})})]})]})}function i(){return(0,s.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-center mb-8",children:"Attendance Dashboard"}),(0,s.jsx)(l,{})]})})}},4482:function(e,t,r){"use strict";r.d(t,{AW:function(){return m},JR:function(){return c},YF:function(){return l},mU:function(){return d},zI:function(){return i}});var s=r(8199);r(4715),r(3884),r(6869),s.Z.apps.length||s.Z.initializeApp({apiKey:"AIzaSyBs1cXvJJ6RWZFJ7zuWpqumqkaalBNaVD8",authDomain:"veriface-attendance.firebaseapp.com",projectId:"veriface-attendance",storageBucket:"veriface-attendance.firebasestorage.app",messagingSenderId:"468894802308",appId:"1:468894802308:web:1f1ef817cc3923e0823dd1"});let a=s.Z.firestore();s.Z.auth(),s.Z.storage();let n="attendance",o="users",l=async e=>{try{let t=new Date;t.setHours(0,0,0,0);let r=a.collection(n).where("userId","==",e.userId).where("timestamp",">=",s.Z.firestore.Timestamp.fromDate(t)).limit(1),o=await r.get();if(!o.empty)return console.log("Attendance already marked for today"),o.docs[0].id;let l=await a.collection(n).add({...e,timestamp:s.Z.firestore.Timestamp.fromDate(e.timestamp)});return console.log("Attendance marked with ID:",l.id),l.id}catch(e){throw console.error("Error marking attendance:",e),e}},i=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{let t=a.collection(n).orderBy("timestamp","desc").limit(e),r=await t.get(),s=[];return r.forEach(e=>{let t=e.data();s.push({id:e.id,userId:t.userId,userName:t.userName,timestamp:t.timestamp.toDate(),confidence:t.confidence,photoUrl:t.photoUrl,status:t.status||"present",location:t.location})}),s}catch(e){throw console.error("Error fetching attendance records:",e),e}},d=async()=>{try{let e=new Date;e.setHours(0,0,0,0);let t=a.collection(n).where("timestamp",">=",s.Z.firestore.Timestamp.fromDate(e)).orderBy("timestamp","desc"),r=await t.get(),o=[];return r.forEach(e=>{let t=e.data();o.push({id:e.id,userId:t.userId,userName:t.userName,timestamp:t.timestamp.toDate(),confidence:t.confidence,photoUrl:t.photoUrl,status:t.status||"present",location:t.location})}),o}catch(e){throw console.error("Error fetching today's attendance:",e),e}},c=async e=>{try{let t=a.collection(o).doc(e.id);await t.set({...e,descriptor:e.descriptor?Array.from(e.descriptor):null,createdAt:s.Z.firestore.FieldValue.serverTimestamp()}),console.log("User saved successfully")}catch(e){throw console.error("Error saving user:",e),e}},m=async()=>{try{let e=await a.collection(o).get(),t=[];return e.forEach(e=>{var r;let s=e.data();t.push({id:e.id,name:s.name,email:s.email,descriptor:s.descriptor?new Float32Array(s.descriptor):void 0,photoUrl:s.photoUrl,role:s.role,createdAt:null===(r=s.createdAt)||void 0===r?void 0:r.toDate()})}),t}catch(e){return console.error("Error fetching users:",e),[]}}},1011:function(e,t,r){"use strict";function s(e){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}function a(e){return new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(e)}function n(e){let t=e.getHours(),r=e.getMinutes();return t<9||9===t&&r<=15?"present":t<10?"late":"absent"}function o(){return"user_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}r.d(t,{mr:function(){return a},p6:function(){return s},zK:function(){return n},zt:function(){return o}})}},function(e){e.O(0,[358,349,573,971,938,744],function(){return e(e.s=5514)}),_N_E=e.O()}]);